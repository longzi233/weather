<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>æ°”è±¡æ•°æ®å¯è§†åŒ–å¹³å° - é£åœºåœ°å›¾</title>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<style>
			:root {
				/* é¢œè‰²å˜é‡ */
				--primary-bg: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
				--header-bg: rgba(10, 30, 50, 0.85);
				--card-bg: rgba(30, 50, 70, 0.5);
				--card-hover-bg: rgba(30, 50, 70, 0.7);
				--primary-blue: #5bc0de;
				--light-blue: #9be6ff;
				--text-color: #e0e7ff;
				--text-secondary: #aaccff;
				--accent-yellow: #ffcc00;
				--success-green: #4CAF50;
				--error-red: #ff6b6b;

				/* å°ºå¯¸å˜é‡ */
				--border-radius: 15px;
				--card-padding: 2rem;
				--section-spacing: 4rem;
				--header-height: 70px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
			}

			body {
				background: var(--primary-bg);
				color: var(--text-color);
				line-height: 1.6;
				min-height: 100vh;
				overflow-x: hidden;
			}

			/* å¤´éƒ¨æ ·å¼ */
			header {
				background: var(--header-bg);
				color: white;
				padding: 1rem 0;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(10px);
				position: sticky;
				top: 0;
				z-index: 1000;
			}

			.container {
				width: 90%;
				max-width: 1400px;
				margin: 0 auto;
			}

			.header-content {
				display: flex;
				justify-content: space-between;
				align-items: center;
				flex-wrap: wrap;
				gap: 1rem;
			}

			.logo {
				display: flex;
				align-items: center;
				gap: 12px;
				font-size: 1.8rem;
				font-weight: bold;
				color: var(--primary-blue);
			}

			.logo-icon {
				font-size: 2.2rem;
				animation: pulse 2s infinite;
			}

			@keyframes pulse {

				0%,
				100% {
					transform: scale(1);
				}

				50% {
					transform: scale(1.1);
				}
			}

			/* å¯¼èˆªæ ·å¼ */
			nav ul {
				display: flex;
				list-style: none;
				gap: 1.5rem;
				flex-wrap: wrap;
				justify-content: center;
			}

			nav ul li a {
				color: var(--text-secondary);
				text-decoration: none;
				font-weight: 500;
				padding: 8px 15px;
				border-radius: 20px;
				transition: all 0.3s;
				position: relative;
				display: inline-block;
			}

			nav ul li a:hover,
			nav ul li a.active {
				background: rgba(91, 192, 222, 0.2);
				color: var(--primary-blue);
			}

			nav ul li a::after {
				content: '';
				position: absolute;
				bottom: -5px;
				left: 50%;
				width: 0;
				height: 3px;
				background: var(--primary-blue);
				border-radius: 2px;
				transform: translateX(-50%);
				transition: width 0.3s;
			}

			nav ul li a:hover::after {
				width: 70%;
			}

			/* æœç´¢æ æ ·å¼ */
			.search-bar {
				margin: 1.5rem auto;
				display: flex;
				max-width: 600px;
			}

			.search-bar input {
				flex: 1;
				padding: 0.9rem 1.2rem;
				border: none;
				border-radius: 30px 0 0 30px;
				font-size: 1.05rem;
				background: rgba(255, 255, 255, 0.1);
				color: white;
				border: 1px solid rgba(91, 192, 222, 0.3);
				border-right: none;
			}

			.search-bar input::placeholder {
				color: var(--text-secondary);
			}

			.search-bar button {
				padding: 0.9rem 1.8rem;
				background: linear-gradient(90deg, var(--primary-blue), #4a90e2);
				border: none;
				border-radius: 0 30px 30px 0;
				cursor: pointer;
				font-weight: bold;
				color: white;
				transition: all 0.3s;
			}

			.search-bar button:hover {
				background: linear-gradient(90deg, #4a90e2, var(--primary-blue));
				box-shadow: 0 0 15px rgba(91, 192, 222, 0.5);
			}

			.search-container {
				position: relative;
				margin: 1.5rem auto;
				display: flex;
				max-width: 600px;
				align-items: center;
			}

			.search-reset {
				margin-left: 10px;
				padding: 0.8rem 1.2rem;
				background: linear-gradient(90deg, #ff6b6b, #ff8787);
				border: none;
				border-radius: 30px;
				cursor: pointer;
				font-weight: bold;
				color: white;
				transition: all 0.3s;
				display: none;
			}

			.search-reset:hover {
				background: linear-gradient(90deg, #ff8787, #ff6b6b);
				box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
			}

			.search-suggestions {
				position: absolute;
				top: 100%;
				left: 0;
				right: 0;
				background: rgba(30, 50, 70, 0.95);
				border-radius: 0 0 15px 15px;
				max-height: 200px;
				overflow-y: auto;
				z-index: 1000;
				display: none;
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
			}

			.search-suggestion-item {
				padding: 10px 15px;
				cursor: pointer;
				transition: background 0.2s;
				color: #e0e7ff;
			}

			.search-suggestion-item:hover {
				background: rgba(91, 192, 222, 0.3);
			}

			/* ä¸»æ¨ªå¹…åŒºåŸŸ */
			.hero {
				height: 500px;
				display: flex;
				align-items: center;
				color: white;
				text-align: center;
				position: relative;
				overflow: hidden;
				margin-top: 20px;
				border-radius: var(--border-radius);
				background: linear-gradient(135deg, rgba(15, 32, 39, 0.8), rgba(44, 83, 100, 0.6)),
					radial-gradient(circle at center, rgba(91, 192, 222, 0.2), transparent 70%);
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
			}

			.hero-content {
				position: relative;
				z-index: 1;
				width: 100%;
				padding: 0 20px;
			}

			.hero h1 {
				font-size: 3.2rem;
				margin-bottom: 1.5rem;
				text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
				background: linear-gradient(to right, var(--primary-blue), var(--light-blue));
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
			}

			.hero p {
				font-size: 1.4rem;
				max-width: 800px;
				margin: 0 auto 3rem;
				font-weight: 300;
				color: #e0f7ff;
			}

			/* æŒ‰é’®æ ·å¼ */
			.btn {
				display: inline-block;
				padding: 1rem 2.2rem;
				background: linear-gradient(90deg, var(--primary-blue), #4a90e2);
				color: white;
				text-decoration: none;
				borderRadius: 30px;
				font-weight: bold;
				font-size: 1.1rem;
				transition: all 0.3s;
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
				border: none;
				cursor: pointer;
			}

			.btn:hover {
				transform: translateY(-3px);
				box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
				background: linear-gradient(90deg, #4a90e2, var(--primary-blue));
			}

			/* é€šç”¨å¡ç‰‡æ ·å¼ */
			.card {
				background: var(--card-bg);
				border-radius: var(--border-radius);
				padding: var(--card-padding);
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
				transition: all 0.4s;
				backdrop-filter: blur(10px);
				border: 1px solid rgba(91, 192, 222, 0.2);
			}

			.card:hover {
				transform: translateY(-10px);
				box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
				border-color: rgba(91, 192, 222, 0.4);
				background: var(--card-hover-bg);
			}

			/* ç‰¹æ€§åŒºåŸŸ */
			.features {
				padding: var(--section-spacing) 0;
			}

			.section-title {
				text-align: center;
				margin-bottom: 3rem;
			}

			.section-title h2 {
				font-size: 2.5rem;
				color: var(--primary-blue);
				margin-bottom: 1rem;
				position: relative;
				display: inline-block;
			}

			.section-title h2::after {
				content: '';
				position: absolute;
				bottom: -10px;
				left: 50%;
				transform: translateX(-50%);
				width: 100px;
				height: 4px;
				background: linear-gradient(90deg, var(--primary-blue), #4a90e2);
				border-radius: 2px;
			}

			.section-title p {
				color: var(--text-secondary);
				max-width: 700px;
				margin: 0 auto;
				font-size: 1.2rem;
			}

			.features-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
				gap: 2rem;
			}

			.feature-card {
				composes: card;
				display: flex;
				flex-direction: column;
				height: 100%;
			}

			.feature-icon {
				font-size: 3.5rem;
				margin-bottom: 1.5rem;
				text-align: center;
				color: var(--primary-blue);
			}

			.feature-card h3 {
				margin-bottom: 1.2rem;
				color: var(--primary-blue);
				font-size: 1.8rem;
				text-align: center;
				position: relative;
			}

			.feature-card p {
				color: #cce0ff;
				flex-grow: 1;
				font-size: 1.1rem;
				line-height: 1.8;
			}

			.feature-card .tech-list {
				margin-top: 1.5rem;
				display: flex;
				flex-wrap: wrap;
				gap: 8px;
			}

			.feature-card .tech-tag {
				background: rgba(91, 192, 222, 0.2);
				color: var(--primary-blue);
				padding: 5px 12px;
				border-radius: 15px;
				font-size: 0.85rem;
			}

			/* åœ°å›¾å®¹å™¨ */
			.windy-map-container {
				position: relative;
				height: 700px;
				border-radius: var(--border-radius);
				overflow: hidden;
				box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
				border: 1px solid rgba(91, 192, 222, 0.3);
				background: rgba(10, 25, 40, 0.2);
				margin: 25px 0;
			}

			.windy-map-container::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: radial-gradient(circle at center, rgba(91, 192, 222, 0.1) 0%, transparent 70%);
				pointer-events: none;
				z-index: 0;
			}

			#windy-map {
				width: 100%;
				height: 100%;
			}

			/* åœ°å›¾æ§ä»¶æ ·å¼ */
			.map-control {
				background: rgba(15, 40, 65, 0.9);
				padding: 10px 15px;
				border-radius: 20px;
				z-index: 20;
				backdrop-filter: blur(5px);
				border: 1px solid rgba(91, 192, 222, 0.3);
				color: var(--light-blue);
			}

			.windy-legend,
			.windy-info-panel {
				composes: map-control;
				position: absolute;
				bottom: 30px;
				min-width: 200px;
			}

			.windy-legend {
				left: 30px;
			}

			.windy-info-panel {
				right: 30px;
				min-width: 250px;
			}

			.legend-title {
				color: var(--primary-blue);
				margin-bottom: 10px;
				text-align: center;
				font-weight: 600;
			}

			.legend-scale {
				height: 20px;
				background: linear-gradient(to right, #00a0ff, #00d4ff, #2ae0c8, #80ff72, #f9f871, #ffb978, #ff7b7b, #ff3e3e);
				border-radius: 5px;
				margin-bottom: 10px;
			}

			.legend-labels {
				display: flex;
				justify-content: space-between;
				font-size: 0.85rem;
				color: var(--text-secondary);
			}

			.info-title {
				color: var(--primary-blue);
				font-weight: 600;
				margin-bottom: 10px;
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.info-content {
				display: grid;
				grid-template-columns: auto auto;
				gap: 8px 15px;
				font-size: 0.9rem;
			}

			.info-label {
				color: var(--light-blue);
				font-weight: 500;
			}

			.info-value {
				color: var(--accent-yellow);
				font-weight: 600;
				text-align: right;
			}

			.map-tips {
				composes: map-control;
				position: absolute;
				top: 20px;
				left: 50%;
				transform: translateX(-50%);
				font-size: 0.9rem;
			}

			.time-controls {
				composes: map-control;
				position: absolute;
				top: 20px;
				right: 20px;
				display: flex;
				gap: 10px;
				align-items: center;
			}

			.time-btn {
				background: transparent;
				border: none;
				color: var(--light-blue);
				font-size: 1.2rem;
				cursor: pointer;
				padding: 5px;
				border-radius: 50%;
				width: 30px;
				height: 30px;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: background 0.3s;
			}

			.time-btn:hover {
				background: rgba(91, 192, 222, 0.3);
			}

			.time-display {
				color: var(--accent-yellow);
				font-weight: 600;
				min-width: 120px;
				text-align: center;
				padding: 0 10px;
				font-size: 0.9rem;
			}

			.loading-overlay {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(10, 25, 40, 0.8);
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				z-index: 100;
				color: var(--primary-blue);
				font-size: 1.5rem;
				gap: 20px;
				transition: opacity 0.5s;
			}

			.spinner {
				width: 50px;
				height: 50px;
				border: 5px solid rgba(91, 192, 222, 0.3);
				border-top: 5px solid var(--primary-blue);
				border-radius: 50%;
				animation: spin 1s linear infinite;
			}

			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}

				100% {
					transform: rotate(360deg);
				}
			}

			/* åŸå¸‚å¤©æ°”åŒºåŸŸ */
			.city-weather {
				padding: 4rem 0;
			}

			.city-weather-container {
				position: relative;
				overflow-x: auto;
				overflow-y: hidden;
				padding: 10px 0 30px;
				scroll-behavior: smooth;
				width: 100%;
				/* æ˜¾ç¤ºè‡ªå®šä¹‰æ»šåŠ¨æ¡ */
				scrollbar-width: thin;
				scrollbar-color: var(--primary-blue) rgba(91, 192, 222, 0.2);
			}

			/* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ - Webkitæµè§ˆå™¨ */
			.city-weather-container::-webkit-scrollbar {
				height: 8px;
			}

			.city-weather-container::-webkit-scrollbar-track {
				background: rgba(91, 192, 222, 0.2);
				border-radius: 4px;
			}

			.city-weather-container::-webkit-scrollbar-thumb {
				background: var(--primary-blue);
				border-radius: 4px;
			}

			.city-weather-container::-webkit-scrollbar-thumb:hover {
				background: var(--light-blue);
			}

			.city-grid {
				display: flex;
				gap: 1.5rem;
				padding: 10px 20px;
				width: max-content;
			}

			.city-card {
				background: rgba(30, 50, 70, 0.5);
				border-radius: 15px;
				overflow: hidden;
				min-height: 320px;
				width: 240px;
				/* å‡å°å¡ç‰‡å®½åº¦ */
				flex: 0 0 auto;
				transition: all 0.3s ease;
				backdrop-filter: blur(10px);
				border: 1px solid rgba(91, 192, 222, 0.2);
			}

			.city-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
				border-color: rgba(91, 192, 222, 0.4);
				background: rgba(30, 50, 70, 0.7);
			}

			.city-header {
				background: linear-gradient(90deg, #1e5799, #207cca);
				color: white;
				padding: 1rem;
				text-align: center;
				position: relative;
			}

			.city-header h3 {
				font-size: 1.4rem;
				margin-bottom: 5px;
				color: white;
			}

			.city-header p {
				font-size: 0.8rem;
				opacity: 0.9;
			}

			.city-content {
				padding: 1.2rem;
				text-align: center;
			}

			/* å¯¼èˆªæŒ‰é’® */
			.nav-button {
				position: absolute;
				top: 50%;
				transform: translateY(-50%);
				width: 40px;
				height: 40px;
				background: rgba(30, 50, 70, 0.8);
				border: none;
				border-radius: 50%;
				color: var(--primary-blue);
				font-size: 1.2rem;
				cursor: pointer;
				z-index: 10;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.3s;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
			}

			.nav-button:hover {
				background: var(--primary-blue);
				color: white;
				transform: translateY(-50%) scale(1.1);
			}

			.nav-button.prev {
				left: 10px;
			}

			.nav-button.next {
				right: 10px;
			}

			.weather-icon {
				font-size: 2.5rem;
				margin: 0.8rem 0;
				color: #ffcc00;
				text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
			}

			.temp {
				font-size: 1.8rem;
				font-weight: bold;
				margin-bottom: 0.8rem;
				color: #ffcc00;
			}

			.city-content p {
				margin: 6px 0;
				color: #cce0ff;
				font-size: 0.9rem;
				display: flex;
				justify-content: space-between;
			}

			.air-quality {
				margin-top: 12px;
				padding: 8px;
				background: rgba(91, 192, 222, 0.1);
				border-radius: 8px;
			}

			.aqi-value {
				font-size: 1.2rem;
				font-weight: bold;
				margin-bottom: 5px;
			}

			.pm-value {
				font-size: 0.8rem;
			}

			.nav-button,
			.city-indicators {
				display: none;
			}

			/* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
			.scroll-indicator {
				position: relative;
				height: 6px;
				background: rgba(91, 192, 222, 0.2);
				border-radius: 3px;
				margin: 10px auto 0;
				max-width: 400px;
				overflow: hidden;
			}

			.scroll-progress {
				height: 100%;
				width: 0%;
				background: var(--primary-blue);
				border-radius: 3px;
				transition: width 0.3s ease;
			}

			/* æ·»åŠ æ»šåŠ¨æç¤º */
			.scroll-hint {
				text-align: center;
				color: var(--text-secondary);
				font-size: 0.9rem;
				margin-top: 5px;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 5px;
			}

			.city-indicators {
				display: flex;
				justify-content: center;
				margin-top: 20px;
				gap: 10px;
			}

			.indicator {
				width: 10px;
				height: 10px;
				border-radius: 50%;
				background: rgba(91, 192, 222, 0.3);
				cursor: pointer;
				transition: all 0.3s;
			}

			.indicator.active {
				background: var(--primary-blue);
				transform: scale(1.2);
			}

			/* æ•°æ®éƒ¨åˆ†æ ·å¼ */
			.data-section {
				padding: var(--section-spacing) 0;
			}

			.data-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
				gap: 2rem;
				margin-top: 2rem;
			}

			.data-card {
				composes: card;
			}

			.data-card h3 {
				color: var(--primary-blue);
				margin-bottom: 1.5rem;
				font-size: 1.5rem;
				text-align: center;
			}

			.data-chart {
				height: 300px;
			}

			.data-status {
				text-align: center;
				padding: 20px;
				color: var(--text-secondary);
				font-size: 1.1rem;
			}

			.retry-button {
				margin-top: 15px;
				padding: 8px 20px;
				background: linear-gradient(90deg, var(--primary-blue), #4a90e2);
				color: white;
				border: none;
				border-radius: 20px;
				cursor: pointer;
				font-weight: 500;
				transition: all 0.3s;
			}

			.retry-button:hover {
				background: linear-gradient(90deg, #4a90e2, var(--primary-blue));
				transform: translateY(-2px);
			}

			/* åº“ä¿¡æ¯éƒ¨åˆ† */
			.lib-info {
				background: rgba(20, 40, 60, 0.88);
				border-radius: var(--border-radius);
				padding: 30px;
				margin-top: 30px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
				border: 1px solid rgba(91, 192, 222, 0.25);
				position: relative;
			}

			.lib-info::after {
				content: '';
				position: absolute;
				top: -10px;
				left: 50%;
				transform: translateX(-50%);
				width: 60%;
				height: 4px;
				background: linear-gradient(90deg, transparent, var(--primary-blue), transparent);
				border-radius: 2px;
			}

			.lib-info h2 {
				color: var(--primary-blue);
				margin-bottom: 25px;
				text-align: center;
				font-size: 2.2rem;
				text-shadow: 0 0 10px rgba(91, 192, 222, 0.4);
				position: relative;
				padding-bottom: 15px;
			}

			.lib-info h2::after {
				content: '';
				position: absolute;
				bottom: 0;
				left: 50%;
				transform: translateX(-50%);
				width: 100px;
				height: 3px;
				background: linear-gradient(90deg, var(--primary-blue), #4a90e2);
				border-radius: 2px;
			}

			.dependencies-info {
				background: rgba(25, 50, 75, 0.7);
				padding: 25px;
				border-radius: 12px;
				margin-bottom: 30px;
				position: relative;
			}

			.dependencies-info h3 {
				color: var(--accent-yellow);
				margin-bottom: 20px;
				font-size: 1.5rem;
				text-align: center;
			}

			.dependency-list {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 20px;
			}

			.dependency-item {
				background: rgba(15, 35, 55, 0.8);
				padding: 15px;
				border-radius: 10px;
				border-left: 3px solid var(--primary-blue);
				color: #d0e8ff;
			}

			.dependency-item h4 {
				color: var(--primary-blue);
				margin-bottom: 10px;
			}

			.dependency-item p {
				color: #d0e8ff;
				line-height: 1.7;
			}

			.dependency-item .local-file-status {
				display: block;
				margin-top: 10px;
				padding: 8px;
				background: rgba(91, 192, 222, 0.1);
				border-radius: 5px;
				color: #aaffaa;
				font-size: 0.9rem;
			}

			/* é¡µè„šæ ·å¼ */
			footer {
				background: rgba(10, 25, 40, 0.9);
				color: var(--text-secondary);
				padding: 3rem 0 1.5rem;
				text-align: center;
				margin-top: 4rem;
				border-top: 1px solid rgba(91, 192, 222, 0.2);
			}

			.footer-links {
				display: flex;
				justify-content: center;
				margin-bottom: 2rem;
				flex-wrap: wrap;
				gap: 1.5rem;
			}

			.footer-links a {
				color: var(--primary-blue);
				text-decoration: none;
				transition: all 0.3s;
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.footer-links a:hover {
				color: var(--light-blue);
				transform: translateY(-2px);
			}

			footer p {
				margin: 8px 0;
				font-size: 0.95rem;
				opacity: 0.8;
			}

			.social-icons {
				display: flex;
				justify-content: center;
				gap: 20px;
				margin: 1.5rem 0;
			}

			.social-icon {
				width: 45px;
				height: 45px;
				border-radius: 50%;
				background: rgba(91, 192, 222, 0.2);
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 1.3rem;
				color: var(--primary-blue);
				transition: all 0.3s;
			}

			.social-icon:hover {
				background: var(--primary-blue);
				color: white;
				transform: translateY(-5px);
			}

			/* çŠ¶æ€æ  */
			.status-bar {
				position: fixed;
				bottom: 20px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(15, 40, 65, 0.9);
				padding: 12px 25px;
				border-radius: 30px;
				font-size: 1.1rem;
				color: var(--primary-blue);
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
				backdrop-filter: blur(10px);
				border: 1px solid rgba(91, 192, 222, 0.3);
				z-index: 1000;
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.status-indicator {
				width: 12px;
				height: 12px;
				border-radius: 50%;
				background: var(--success-green);
				box-shadow: 0 0 10px var(--success-green);
				animation: pulse-status 1.5s infinite;
			}

			@keyframes pulse-status {

				0%,
				100% {
					opacity: 0.6;
				}

				50% {
					opacity: 1;
				}
			}

			/* è¾…åŠ©ç±» */
			.clickable-chart {
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.clickable-chart:hover {
				box-shadow: 0 0 20px rgba(91, 192, 222, 0.5);
			}

			.chart-title-with-link {
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.view-all-link {
				font-size: 0.9rem;
				color: var(--light-blue);
				text-decoration: none;
				display: flex;
				align-items: center;
				gap: 5px;
			}

			.view-all-link:hover {
				color: var(--primary-blue);
				text-decoration: underline;
			}

			.error-message {
				background: rgba(200, 0, 0, 0.2);
				border: 1px solid rgba(255, 0, 0, 0.3);
				border-radius: 5px;
				padding: 10px;
				margin: 10px 0;
				color: var(--error-red);
			}

			.wind-rose-title {
				text-align: center;
				color: var(--primary-blue);
				margin-top: 10px;
				font-size: 1.2rem;
				font-weight: bold;
			}

			.search-results {
				margin-top: 1rem;
				text-align: center;
			}

			.no-results {
				color: var(--error-red);
				padding: 1rem;
				background: rgba(255, 107, 107, 0.1);
				border-radius: 8px;
				margin-top: 1rem;
			}

			.highlight-card {
				animation: highlight 2s ease;
				box-shadow: 0 0 20px rgba(91, 192, 222, 0.7) !important;
			}

			@keyframes highlight {

				0%,
				100% {
					transform: scale(1);
				}

				50% {
					transform: scale(1.03);
				}
			}

			/* å“åº”å¼è®¾è®¡ */
			@media (max-width: 1200px) {
				.city-card {
					flex: 0 0 calc(33.333% - 2rem);
				}
			}

			@media (max-width: 900px) {
				.city-card {
					flex: 0 0 calc(50% - 2rem);
				}

				.windy-map-container {
					height: 500px;
				}

				.time-controls {
					gap: 8px;
				}

				.data-grid {
					grid-template-columns: 1fr;
				}
			}

			@media (max-width: 768px) {
				.city-card {
					width: 220px;
					min-height: 300px;
				}

				.city-grid {
					gap: 1rem;
				}

				.header-content {
					flex-direction: column;
					text-align: center;
				}

				.hero h1 {
					font-size: 2.2rem;
				}

				.hero p {
					font-size: 1.1rem;
				}

				.windy-legend,
				.windy-info-panel {
					position: relative;
					bottom: auto;
					left: auto;
					right: auto;
					width: 100%;
					margin: 15px 0;
				}
			}

			@media (max-width: 600px) {
				.city-card {
					flex: 0 0 calc(100% - 2rem);
				}

				.nav-button {
					width: 35px;
					height: 35px;
				}

				.city-header {
					padding: 1.5rem;
				}

				.city-header h3 {
					font-size: 1.8rem;
				}

				.city-content {
					padding: 1.8rem;
				}

				.weather-icon {
					font-size: 3.5rem;
				}

				.temp {
					font-size: 2.5rem;
				}

				.city-content p {
					font-size: 1.1rem;
				}

				.windy-map-container {
					height: 400px;
				}
			}

			@keyframes pulse-status {
				0% {
					opacity: 0.6;
				}

				50% {
					opacity: 1;
				}

				100% {
					opacity: 0.6;
				}
			}

			@media (max-width: 900px) {
				.windy-map-container {
					height: 500px;
				}

				.time-controls {
					gap: 8px;
				}

				.data-grid {
					grid-template-columns: 1fr;
				}
			}

			@media (max-width: 768px) {
				.header-content {
					flex-direction: column;
					text-align: center;
					gap: 1rem;
				}

				nav ul {
					justify-content: center;
					flex-wrap: wrap;
				}

				.hero h1 {
					font-size: 2.2rem;
				}

				.hero p {
					font-size: 1.1rem;
				}

				.windy-legend,
				.windy-info-panel {
					position: relative;
					bottom: auto;
					left: auto;
					right: auto;
					width: 100%;
					margin: 15px 0;
				}

				.nav-button {
					display: none;
				}

				/* ç§»åŠ¨è®¾å¤‡ä¸Šæ˜¾ç¤ºæ»šåŠ¨æç¤º */
				.scroll-hint {
					display: flex;
				}
			}

			@media (max-width: 500px) {
				.windy-map-container {
					height: 400px;
				}
			}

			@media (max-width: 480px) {
				.city-card {
					width: 200px;
					min-height: 280px;
				}

				.city-content {
					padding: 1rem;
				}

				.temp {
					font-size: 1.6rem;
				}
			}

			@keyframes highlight {
				0% {
					transform: scale(1);
				}

				50% {
					transform: scale(1.03);
				}

				100% {
					transform: scale(1);
				}
			}
		</style>
	</head>
	<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">ğŸŒªï¸</span>
                    <span>æ°”è±¡æ•°æ®å¯è§†åŒ–å¹³å°</span>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="active">é¦–é¡µ</a></li>
                        <li><a href="#city-weather">å®æ—¶å¤©æ°”</a></li>
                        <li><a href="#wind-map-section">æ°”è±¡åœ°å›¾</a></li>
                        <li><a href="#data-section">æ•°æ®åˆ†æ</a></li>
                    </ul>
                </nav>
            </div>
            <div class="search-bar">
                <input type="text" id="city-search-input" placeholder="è¾“å…¥åŸå¸‚åç§°æŸ¥è¯¢å®æ—¶å¤©æ°”...">
                <button id="search-button">æœç´¢</button>
            </div>
            <button class="search-reset" id="reset-button">å¤ä½</button>
            <div class="search-suggestions" id="search-suggestions"></div>
            <div class="search-results" id="search-results"></div>
        </div>
    </header>

		<section class="hero">
			<div class="hero-content">
				<h1>å…¨å›½æ°”è±¡æ•°æ®å¯è§†åŒ–åˆ†æå¹³å°</h1>
				<p>åŸºäºEChartsä¸GLæŠ€æœ¯çš„é«˜çº§æ°”è±¡å¯è§†åŒ–ç³»ç»Ÿï¼Œæä¾›ç²¾å‡†çš„å¤©æ°”æ•°æ®ã€åŠ¨æ€é£åœºå±•ç¤ºä¸æ·±åº¦æ°”å€™åˆ†æ</p>
				<a href="#wind-map-section" class="btn">æ¢ç´¢å®æ—¶æ°”è±¡åœ°å›¾</a>
			</div>
		</section>
		<section class="city-weather" id="city-weather">
			<div class="container">
				<div class="section-title">
					<h2>ä¸»è¦åŸå¸‚å®æ—¶å¤©æ°”</h2>
					<p>å…¨å›½é‡ç‚¹åŸå¸‚æ°”è±¡æ•°æ®ç›‘æµ‹ä¸åˆ†æ</p>
				</div>

				<div class="city-weather-wrapper">
					<button class="nav-button prev" id="prev-button">
						<i class="fas fa-chevron-left"></i>
					</button>

					<div class="city-weather-container">
						<div class="city-grid" id="city-cards-container">
						</div>
					</div>

					<button class="nav-button next" id="next-button">
						<i class="fas fa-chevron-right"></i>
					</button>
				</div>

				<div class="scroll-indicator">
					<div class="scroll-progress" id="scroll-progress"></div>
				</div>
				<div class="scroll-hint">
					<i class="fas fa-info-circle"></i> å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ‰€æœ‰åŸå¸‚
				</div>
			</div>
		</section>

<section class="weather-map-section" id="wind-map-section">
  <div class="container">
    <div class="section-title">
      <h2>å…¨å›½ä¸»è¦åŸå¸‚å®æ—¶å¤©æ°”åœ°å›¾</h2>
    </div>

    <!-- åœ°å›¾å›¾ç‰‡ -->
    <div style="text-align: center; margin-top: 20px;">
      <img src="libs/china-map.png" alt="ä¸­å›½åœ°å›¾" style="width: 100%; max-width: 800px; border: 1px solid #ccc; border-radius: 6px;">
    </div>

    <!-- æŸ¥çœ‹è¯¦ç»†æŒ‰é’® -->
    <div style="text-align: center; margin-top: 15px;">
      <a href="map.html" style="padding: 8px 16px; background-color: #409EFF; color: white; text-decoration: none; border-radius: 4px;">æŸ¥çœ‹è¯¦ç»†</a>
    </div>
  </div>
</section>

<script>
  // åŸå¸‚åˆ—è¡¨
  const cities = [
    { name: "åŒ—äº¬", lon: 116.40, lat: 39.90 },
    { name: "ä¸Šæµ·", lon: 121.47, lat: 31.23 },
    { name: "å¹¿å·", lon: 113.27, lat: 23.13 },
    { name: "æ·±åœ³", lon: 114.05, lat: 22.55 },
    { name: "æˆéƒ½", lon: 104.06, lat: 30.67 }
  ];

  // æ¨¡æ‹ŸåŸå¸‚å¤©æ°”æ•°æ®ï¼ˆå¯æ›¿æ¢ä¸ºåç«¯æ¥å£è¿”å›ï¼‰
  async function fetchCityWeatherData() {
    return cities.map(c => ({
      name: c.name,
      lon: c.lon,
      lat: c.lat,
      temp: (15 + Math.random() * 15).toFixed(1),
      wind: (Math.random() * 10).toFixed(1),
      humidity: (40 + Math.random() * 40).toFixed(0)
    }));
  }

  // æ¸²æŸ“åŸå¸‚æ•£ç‚¹åˆ°åœ°å›¾
  function renderCityWeatherOnMap(cityWeatherData) {
    if (!windyChart) return;

    const scatterSeries = {
      name: "åŸå¸‚å®æ—¶å¤©æ°”",
      type: "scatter",
      coordinateSystem: "geo",
      symbol: "circle",
      symbolSize: 12,
      itemStyle: { color: "#ffcc00", borderColor: "#fff", borderWidth: 1 },
      data: cityWeatherData.map(c => ({
        name: c.name,
        value: [c.lon, c.lat, c.temp, c.wind, c.humidity]
      })),
      tooltip: {
        formatter: function (p) {
          const v = p.value;
          return `${p.name}<br>
                  æ¸©åº¦: ${v[2]}Â°C<br>
                  é£é€Ÿ: ${v[3]} km/h<br>
                  æ¹¿åº¦: ${v[4]}%`;
        }
      }
    };

    windyChart.setOption({
      series: (windyChart.getOption().series || []).concat([scatterSeries])
    });

    // é»˜è®¤æ˜¾ç¤ºç¬¬ä¸€ä¸ªåŸå¸‚ä¿¡æ¯
    if (cityWeatherData.length > 0) {
      updateCityInfoPanel(cityWeatherData[0]);
    }
  }

  // æ›´æ–°å³ä¾§åŸå¸‚é¢æ¿
  function updateCityInfoPanel(city) {
    document.getElementById("city-name").textContent = city.name;
    document.getElementById("lon-value").textContent = city.lon.toFixed(2) + "Â°E";
    document.getElementById("lat-value").textContent = city.lat.toFixed(2) + "Â°N";
    document.getElementById("temp-value").textContent = city.temp + "Â°C";
    document.getElementById("wind-value").textContent = city.wind + " km/h";
    document.getElementById("wind-dir").textContent = "â€”"; // éœ€è¦çš„è¯å¯æ ¹æ® u,v ç®—
    document.getElementById("humidity-value").textContent = city.humidity + "%";
  }

  // é¡µé¢åŠ è½½æ—¶æ‹‰å–åŸå¸‚å¤©æ°”
  window.addEventListener("DOMContentLoaded", async () => {
    const cityData = await fetchCityWeatherData();
    renderCityWeatherOnMap(cityData);
  });
</script>


		<section class="data-section" id="data-section">
			<div class="container">
				<div class="section-title">
					<h2>æ°”è±¡æ•°æ®åˆ†æ</h2>
					<p>åŸºäºå†å²ä¸å®æ—¶æ•°æ®çš„æ·±åº¦å¯è§†åŒ–åˆ†æ</p>
				</div>

				<div class="data-grid">
					<!-- ä¿®æ”¹åçš„å¹³å‡æ°”æ¸©å›¾è¡¨ -->
					<div class="data-card">
						<div class="chart-title-with-link">
							<h3>ä¸»è¦åŸå¸‚å¹´å¹³å‡æ°”æ¸©</h3>
							<a href="wind-rose.html?chart=temperature" class="view-all-link" id="temperature-link">
								æŸ¥çœ‹å…¨éƒ¨ <i class="fas fa-external-link-alt"></i>
							</a>
						</div>
						<div id="temp-chart" class="data-chart clickable-chart"></div>
					</div>

					<div class="data-card">
						<div class="chart-title-with-link">
							<h3>å…¨å›½å„åœ°å¤©æ°”æƒ…å†µåˆ†å¸ƒ</h3>
							<a href="wind-rose.html?chart=weather" class="view-all-link" id="weather-link">
								æŸ¥çœ‹å…¨éƒ¨ <i class="fas fa-external-link-alt"></i>
							</a>
						</div>
						<div id="weather-chart" class="data-chart clickable-chart"></div>
					</div>

					<div class="data-card">
						<div class="chart-title-with-link">
							<h3>é£é€Ÿä¸é£å‘ç«ç‘°å›¾</h3>
							<a href="wind-rose.html?chart=wind" class="view-all-link" id="wind-rose-link">
								æŸ¥çœ‹å…¨éƒ¨ <i class="fas fa-external-link-alt"></i>
							</a>
						</div>
						<div id="wind-chart" class="data-chart"></div>
						<div class="wind-rose-title" id="wind-rose-city">åŒ—äº¬å¸‚é£å‘æ•°æ®</div>
					</div>
				</div>
			</div>
		</section>

		<section class="lib-info">
			<div class="container">
				<h2>æœ¬åœ°ä¾èµ–æ–‡ä»¶è¯´æ˜</h2>

				<div class="dependencies-info">
					<h3>å·²ä½¿ç”¨çš„æœ¬åœ°ä¾èµ–æ–‡ä»¶</h3>
					<div class="dependency-list">
						<div class="dependency-item">
							<h4>ECharts æ ¸å¿ƒåº“ (echarts.min.js)</h4>
							<p>ç”¨äºåˆ›å»ºäº¤äº’å¼å›¾è¡¨å’Œåœ°å›¾çš„åŸºç¡€åº“ã€‚</p>
							<span class="local-file-status">âœ… å·²ä½¿ç”¨æœ¬åœ°æ–‡ä»¶: libs/echarts.min.js</span>
						</div>
						<div class="dependency-item">
							<h4>ECharts GLæ‰©å±• (echarts-gl.min.js)</h4>
							<p>æä¾›WebGLæ¸²æŸ“èƒ½åŠ›ï¼Œç”¨äºé«˜æ€§èƒ½çš„é£åœºå¯è§†åŒ–ã€‚</p>
							<span class="local-file-status">âœ… å·²ä½¿ç”¨æœ¬åœ°æ–‡ä»¶: libs/echarts-gl.min.js</span>
						</div>
						<div class="dependency-item">
							<h4>ä¸­å›½åœ°å›¾æ•°æ® (china.json)</h4>
							<p>åŒ…å«ä¸­å›½åœ°ç†ä¿¡æ¯æ•°æ®ï¼Œç”¨äºåœ°å›¾æ¸²æŸ“ã€‚</p>
							<span class="local-file-status">âœ… å·²ä½¿ç”¨æœ¬åœ°æ–‡ä»¶: libs/china.json</span>
						</div>
					</div>
				</div>
			</div>
		</section>

		<footer>
			<div class="container">
				<div class="social-icons">
				<p>æ•°æ®æ¥æº: ä¸­å›½å¤©æ°”ç½‘å…¬å¼€æ•°æ®</p>
				<p>Â© æ°”è±¡æ•°æ®å¯è§†åŒ–å¹³å° | åŸºäºECharts GLæŠ€æœ¯æ„å»º</p>
			</div>
		</footer>

		<div class="status-bar">
			<span class="status-indicator"></span>
			<span id="status-text">ç³»ç»ŸçŠ¶æ€: åŠ è½½åœ°å›¾æ•°æ®ä¸­...</span>
		</div>

		<!-- å¼•ç”¨æœ¬åœ°EChartsåº“ -->
		<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/echarts-gl@2.0.9/dist/echarts-gl.min.js"></script>

		<script>
			// å…¨å±€å˜é‡
			let windyChart;
			let currentMode = 'wind';
			let chinaGeoJson = null;
			let weatherData = {}; // å­˜å‚¨åŠ è½½çš„å¤©æ°”æ•°æ®
			let historicalData = {}; // å­˜å‚¨å†å²æ•°æ®

			// çœä¼šåŸå¸‚åˆ—è¡¨åŠå…¶åæ ‡
			const capitalCities = {
				'beijing': {
					name: 'åŒ—äº¬',
					coordinates: [116.41, 39.90]
				},
				'shanghai': {
					name: 'ä¸Šæµ·',
					coordinates: [121.48, 31.22]
				},
				'tianjin': {
					name: 'å¤©æ´¥',
					coordinates: [117.20, 39.13]
				},
				'chongqing': {
					name: 'é‡åº†',
					coordinates: [106.54, 29.59]
				},
				'haerbin': {
					name: 'å“ˆå°”æ»¨',
					coordinates: [126.63, 45.75]
				},
				'changchun': {
					name: 'é•¿æ˜¥',
					coordinates: [125.32, 43.90]
				},
				'shenyang': {
					name: 'æ²ˆé˜³',
					coordinates: [123.43, 41.80]
				},
				'huhehaote': {
					name: 'å‘¼å’Œæµ©ç‰¹',
					coordinates: [111.65, 40.82]
				},
				'shijiazhuang': {
					name: 'çŸ³å®¶åº„',
					coordinates: [114.48, 38.03]
				},
				'xining': {
					name: 'è¥¿å®',
					coordinates: [101.74, 36.56]
				},
				'lanzhou': {
					name: 'å…°å·',
					coordinates: [103.73, 36.03]
				},
				'yinchuan': {
					name: 'é“¶å·',
					coordinates: [106.27, 38.47]
				},
				'xian': {
					name: 'è¥¿å®‰',
					coordinates: [108.93, 34.27]
				},
				'zhengzhou': {
					name: 'éƒ‘å·',
					coordinates: [113.62, 34.72]
				},
				'jinan': {
					name: 'æµå—',
					coordinates: [117.00, 36.65]
				},
				'taiyuan': {
					name: 'å¤ªåŸ',
					coordinates: [112.53, 37.87]
				},
				'hefei': {
					name: 'åˆè‚¥',
					coordinates: [117.27, 31.86]
				},
				'wuhan': {
					name: 'æ­¦æ±‰',
					coordinates: [114.31, 30.52]
				},
				'changsha': {
					name: 'é•¿æ²™',
					coordinates: [113.00, 28.21]
				},
				'nanjing': {
					name: 'å—äº¬',
					coordinates: [118.78, 32.04]
				},
				'chengdu': {
					name: 'æˆéƒ½',
					coordinates: [104.06, 30.67]
				},
				'guiyang': {
					name: 'è´µé˜³',
					coordinates: [106.71, 26.57]
				},
				'kunming': {
					name: 'æ˜†æ˜',
					coordinates: [102.73, 25.04]
				},
				'nanning': {
					name: 'å—å®',
					coordinates: [108.37, 22.82]
				},
				'lasa': {
					name: 'æ‹‰è¨',
					coordinates: [91.11, 29.61]
				},
				'hangzhou': {
					name: 'æ­å·',
					coordinates: [120.19, 30.26]
				},
				'fuzhou': {
					name: 'ç¦å·',
					coordinates: [119.30, 26.08]
				},
				'guangzhou': {
					name: 'å¹¿å·',
					coordinates: [113.23, 23.16]
				},
				'haikou': {
					name: 'æµ·å£',
					coordinates: [110.35, 20.02]
				}
			};

			// å¤©æ°”å›¾æ ‡æ˜ å°„
			const weatherIcons = {
				'æ™´': 'â˜€ï¸',
				'å¤šäº‘': 'â›…',
				'é˜´': 'ğŸŒ¥ï¸',
				'å°é›¨': 'ğŸŒ§ï¸',
				'ä¸­é›¨': 'ğŸŒ§ï¸',
				'å¤§é›¨': 'ğŸŒ§ï¸',
				'æš´é›¨': 'ğŸŒ§ï¸',
				'é›·é˜µé›¨': 'â›ˆï¸',
				'é›ª': 'â„ï¸',
				'é›¾': 'ğŸŒ«ï¸',
				'éœ¾': 'ğŸŒ«ï¸'
			};

			// ç©ºæ°”è´¨é‡ç­‰çº§æ˜ å°„
			const aqiLevelsText = {
				'ä¼˜': {
					color: '#00e400',
					text: 'ç©ºæ°”è´¨é‡: ä¼˜'
				},
				'è‰¯': {
					color: '#ffff00',
					text: 'ç©ºæ°”è´¨é‡: è‰¯'
				},
				'è½»åº¦æ±¡æŸ“': {
					color: '#ff7e00',
					text: 'ç©ºæ°”è´¨é‡: è½»åº¦æ±¡æŸ“'
				},
				'ä¸­åº¦æ±¡æŸ“': {
					color: '#ff0000',
					text: 'ç©ºæ°”è´¨é‡: ä¸­åº¦æ±¡æŸ“'
				},
				'é‡åº¦æ±¡æŸ“': {
					color: '#99004c',
					text: 'ç©ºæ°”è´¨é‡: é‡åº¦æ±¡æŸ“'
				},
				'ä¸¥é‡æ±¡æŸ“': {
					color: '#7e0023',
					text: 'ç©ºæ°”è´¨é‡: ä¸¥é‡æ±¡æŸ“'
				}
			};

			// APIåŸºç¡€URL - è¯·æ ¹æ®æ‚¨çš„å®é™…APIæœåŠ¡å™¨åœ°å€ä¿®æ”¹
			const API_BASE = 'http://localhost:5000/api';

			// å…¨å±€å˜é‡
			let currentCityPage = 0;
			const citiesPerPage = 4;

			const eightDirections = {
				'åŒ—é£': 'N',
				'ä¸œåŒ—é£': 'NE',
				'ä¸œé£': 'E',
				'ä¸œå—é£': 'SE',
				'å—é£': 'S',
				'è¥¿å—é£': 'SW',
				'è¥¿é£': 'W',
				'è¥¿åŒ—é£': 'NW'
			};

			// DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
			document.addEventListener('DOMContentLoaded', function() {
				// åˆå§‹åŒ–åŸå¸‚å¡ç‰‡
				initCityCards();

				// å¯åŠ¨æ•°æ®è½®è¯¢
				setTimeout(startDataPolling, 1000);

				// æ·»åŠ æ»šåŠ¨äº‹ä»¶ç›‘å¬
				initScrollHandler();

				// æ·»åŠ å¯¼èˆªæŒ‰é’®åŠŸèƒ½
				initNavigation();

				// æ·»åŠ æœç´¢åŠŸèƒ½
				initSearchFunctionality();

				// åŠ è½½èµ„æº
				loadResources();
			});

			// åˆå§‹åŒ–æœç´¢åŠŸèƒ½
			function initSearchFunctionality() {
				const searchButton = document.getElementById('search-button');
				const searchInput = document.getElementById('city-search-input');
				const searchResults = document.getElementById('search-results');
				const resetButton = document.getElementById('reset-button');
				const searchSuggestions = document.getElementById('search-suggestions');

				if (!searchButton || !searchInput || !searchResults || !resetButton) return;

				// åˆ›å»ºåŸå¸‚åç§°æ˜ å°„ï¼ˆåŒ…å«æ‰€æœ‰åŸå¸‚ï¼‰
				const cityNameMap = {};
				Object.entries(capitalCities).forEach(([pinyin, cityInfo]) => {
					cityNameMap[cityInfo.name] = pinyin;
					// æ·»åŠ æ‹¼éŸ³æ˜ å°„ä»¥ä¾¿æ”¯æŒæ‹¼éŸ³æœç´¢
					cityNameMap[pinyin] = pinyin;
				});

				// æ·»åŠ å¸¸è§åŸå¸‚åˆ«å
				const cityAliases = {
					'åŒ—äº¬å¸‚': 'beijing',
					'ä¸Šæµ·å¸‚': 'shanghai',
					'å¹¿å·å¸‚': 'guangzhou',
					'æ·±åœ³å¸‚': 'shenzhen',
					'æˆéƒ½å¸‚': 'chengdu',
					'æ­å·å¸‚': 'hangzhou',
					'æ­¦æ±‰å¸‚': 'wuhan',
					'è¥¿å®‰å¸‚': 'xian',
					'å—äº¬å¸‚': 'nanjing',
					'å¤©æ´¥å¸‚': 'tianjin',
					'é‡åº†å¸‚': 'chongqing',
					'æ²ˆé˜³å¸‚': 'shenyang',
					'é’å²›å¸‚': 'qingdao',
					'è‹å·å¸‚': 'suzhou',
					'é•¿æ²™å¸‚': 'changsha',
					'å¤§è¿å¸‚': 'dalian',
					'å¦é—¨å¸‚': 'xiamen',
					'æ— é”¡å¸‚': 'wuxi',
					'å“ˆå°”æ»¨å¸‚': 'haerbin',
					'æµå—å¸‚': 'jinan',
					'å®æ³¢å¸‚': 'ningbo'
				};

				// åˆå¹¶åˆ«ååˆ°åŸå¸‚æ˜ å°„
				Object.assign(cityNameMap, cityAliases);

				// æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
				searchButton.addEventListener('click', function() {
					performSearch();
				});

				// å¤ä½æŒ‰é’®ç‚¹å‡»äº‹ä»¶
				resetButton.addEventListener('click', function() {
					resetSearch();
				});

				// å›è½¦é”®è§¦å‘æœç´¢
				searchInput.addEventListener('keypress', function(e) {
					if (e.key === 'Enter') {
						performSearch();
					}
				});

				// è¾“å…¥æ—¶æ˜¾ç¤ºæœç´¢å»ºè®®
				searchInput.addEventListener('input', function() {
					showSearchSuggestions();
				});

				// ç‚¹å‡»å…¶ä»–åœ°æ–¹éšè—æœç´¢å»ºè®®
				document.addEventListener('click', function(e) {
					if (!searchInput.contains(e.target) && !searchSuggestions.contains(e.target)) {
						searchSuggestions.style.display = 'none';
					}
				});

				// æ‰§è¡Œæœç´¢çš„å‡½æ•°
				function performSearch() {
					const searchTerm = searchInput.value.trim().toLowerCase();
					if (!searchTerm) {
						searchResults.innerHTML = '<div class="no-results">è¯·è¾“å…¥åŸå¸‚åç§°</div>';
						return;
					}

					// æŸ¥æ‰¾åŒ¹é…çš„åŸå¸‚
					let foundCity = null;
					for (const [name, pinyin] of Object.entries(cityNameMap)) {
						if (name.toLowerCase().includes(searchTerm) || searchTerm.includes(name.toLowerCase())) {
							foundCity = pinyin;
							break;
						}
					}

					if (foundCity) {
						// éšè—æ‰€æœ‰åŸå¸‚å¡ç‰‡
						document.querySelectorAll('.city-card').forEach(card => {
							card.style.display = 'none';
						});

						// æ˜¾ç¤ºåŒ¹é…çš„åŸå¸‚å¡ç‰‡
						const targetCard = document.querySelector(`.city-card[data-city="${foundCity}"]`);
						if (targetCard) {
							targetCard.style.display = 'block';

							// æ·»åŠ é«˜äº®æ•ˆæœ
							targetCard.classList.add('highlight-card');
							setTimeout(() => {
								targetCard.classList.remove('highlight-card');
							}, 2000);

							// æ»šåŠ¨åˆ°è¯¥å¡ç‰‡ä½ç½®
							targetCard.scrollIntoView({
								behavior: 'smooth',
								block: 'center'
							});

							searchResults.innerHTML =
								`<div style="color: #5bc0de;">å·²æ‰¾åˆ°åŸå¸‚: ${capitalCities[foundCity].name}</div>`;

							// æ˜¾ç¤ºå¤ä½æŒ‰é’®
							resetButton.style.display = 'block';
						}
					} else {
						searchResults.innerHTML =
							'<div class="no-results">æœªæ‰¾åˆ°åŒ¹é…çš„åŸå¸‚ï¼Œè¯·å°è¯•å…¶ä»–åç§°</div>';

						// æ˜¾ç¤ºæ‰€æœ‰åŸå¸‚å¡ç‰‡
						document.querySelectorAll('.city-card').forEach(card => {
							card.style.display = 'block';
						});

						// éšè—å¤ä½æŒ‰é’®
						resetButton.style.display = 'none';
					}

					// éšè—æœç´¢å»ºè®®
					searchSuggestions.style.display = 'none';
				}

				// å¤ä½æœç´¢çš„å‡½æ•°
				function resetSearch() {
					// æ˜¾ç¤ºæ‰€æœ‰åŸå¸‚å¡ç‰‡
					document.querySelectorAll('.city-card').forEach(card => {
						card.style.display = 'block';
					});

					// æ¸…ç©ºæœç´¢è¾“å…¥å’Œç»“æœ
					searchInput.value = '';
					searchResults.innerHTML = '';

					// éšè—å¤ä½æŒ‰é’®
					resetButton.style.display = 'none';

					// éšè—æœç´¢å»ºè®®
					searchSuggestions.style.display = 'none';
				}

				// æ˜¾ç¤ºæœç´¢å»ºè®®çš„å‡½æ•°
				function showSearchSuggestions() {
					const searchTerm = searchInput.value.trim().toLowerCase();
					if (!searchTerm) {
						searchSuggestions.style.display = 'none';
						return;
					}

					// è·å–åŒ¹é…çš„åŸå¸‚
					const matchedCities = [];
					for (const [name, pinyin] of Object.entries(cityNameMap)) {
						if (name.toLowerCase().includes(searchTerm)) {
							matchedCities.push({
								name: name,
								pinyin: pinyin
							});

							// æœ€å¤šæ˜¾ç¤º8ä¸ªå»ºè®®
							if (matchedCities.length >= 8) break;
						}
					}

					// æ˜¾ç¤ºæœç´¢å»ºè®®
					if (matchedCities.length > 0) {
						searchSuggestions.innerHTML = '';
						matchedCities.forEach(city => {
							const item = document.createElement('div');
							item.className = 'search-suggestion-item';
							item.textContent = city.name;
							item.addEventListener('click', function() {
								searchInput.value = city.name;
								searchSuggestions.style.display = 'none';
								performSearch();
							});
							searchSuggestions.appendChild(item);
						});
						searchSuggestions.style.display = 'block';
					} else {
						searchSuggestions.style.display = 'none';
					}
				}
			}

			// åˆå§‹åŒ–å¯¼èˆªæŒ‰é’®
			function initNavigation() {
				const container = document.querySelector('.city-weather-container');
				const prevButton = document.getElementById('prev-button');
				const nextButton = document.getElementById('next-button');

				if (!container || !prevButton || !nextButton) return;

				// å¯¼èˆªæŒ‰é’®ç‚¹å‡»äº‹ä»¶
				prevButton.addEventListener('click', () => {
					container.scrollBy({
						left: -300,
						behavior: 'smooth'
					});
				});

				nextButton.addEventListener('click', () => {
					container.scrollBy({
						left: 300,
						behavior: 'smooth'
					});
				});

				// æ ¹æ®æ»šåŠ¨ä½ç½®æ›´æ–°æŒ‰é’®çŠ¶æ€
				container.addEventListener('scroll', () => {
					const scrollWidth = container.scrollWidth - container.clientWidth;
					const scrollLeft = container.scrollLeft;

					// æ˜¾ç¤º/éšè—å¯¼èˆªæŒ‰é’®
					prevButton.style.display = scrollLeft > 10 ? 'flex' : 'none';
					nextButton.style.display = scrollLeft < scrollWidth - 10 ? 'flex' : 'none';
				});

				// åˆå§‹éšè—å·¦ç®­å¤´
				prevButton.style.display = 'none';
			}

			// åˆå§‹åŒ–åŸå¸‚å¡ç‰‡
			function initCityCards() {
				const container = document.getElementById('city-cards-container');
				if (!container) return;

				// æ¸…ç©ºå®¹å™¨
				container.innerHTML = '';

				// åˆ›å»ºæ‰€æœ‰åŸå¸‚å¡ç‰‡
				Object.entries(capitalCities).forEach(([key, city]) => {
					const card = createCityCard(city);
					card.dataset.city = key;
					container.appendChild(card);
				});
			}

			// åˆ›å»ºåŸå¸‚å¡ç‰‡
			function createCityCard(cityInfo) {
				const card = document.createElement('div');
				card.className = 'city-card';

				card.innerHTML = `
			        <div class="city-header">
			            <h3>${cityInfo.name}</h3>
			            <p>å®æ—¶ç›‘æµ‹</p>
			        </div>
			        <div class="city-content">
			            <div class="weather-icon">â³</div>
			            <div class="temp">--Â°C</div>
			            <p><span class="info-label">å¤©æ°”:</span> <span class="info-value weather-desc">åŠ è½½ä¸­...</span></p>
			            <p><span class="info-label">æ¹¿åº¦:</span> <span class="info-value humidity">--%</span></p>
			            <p><span class="info-label">é£å‘é£åŠ›:</span> <span class="info-value wind">--</span></p>
			            <div class="air-quality">
			                <div class="aqi-value">AQI: --</div>
			                <div class="pm-value">PM2.5: --</div>
			            </div>
			        </div>
			    `;
				return card;
			}

			// æ›´æ–°åŸå¸‚å¤©æ°”æ•°æ®
			function updateCityWeather(cityKey, data) {
				const cityCard = document.querySelector(`.city-card[data-city="${cityKey}"]`);
				if (!cityCard || !data) return;

				// æ›´æ–°æ¸©åº¦
				const tempElement = cityCard.querySelector('.temp');
				if (tempElement && data.current_temp) {
					tempElement.textContent = `${data.current_temp}Â°C`;
				}

				// æ›´æ–°å¤©æ°”å›¾æ ‡å’Œæè¿°
				const weatherIcon = cityCard.querySelector('.weather-icon');
				const weatherDesc = cityCard.querySelector('.weather-desc');
				if (weatherIcon && weatherDesc && data.weather) {
					weatherIcon.textContent = getWeatherIcon(data.weather);
					weatherDesc.textContent = data.weather;
				}

				// æ›´æ–°æ¹¿åº¦
				const humidityElement = cityCard.querySelector('.humidity');
				if (humidityElement && data.humidity) {
					humidityElement.textContent = data.humidity;
				}

				// æ›´æ–°é£å‘é£åŠ›
				const windElement = cityCard.querySelector('.wind');
				if (windElement && data.wind_direction) {
					windElement.textContent = data.wind_direction;
				}

				// æ›´æ–°ç©ºæ°”è´¨é‡ - ä¿®æ”¹è¿™éƒ¨åˆ†
				const aqiElement = cityCard.querySelector('.aqi-value');
				const pmElement = cityCard.querySelector('.pm-value');

				if (aqiElement) {
					// ä¼˜å…ˆä½¿ç”¨air_qualityå­—æ®µï¼ˆæ–‡å­—æè¿°ï¼‰
					if (data.air_quality) {
						const aqiText = data.air_quality;
						const aqiInfo = aqiLevelsText[aqiText] || {
							text: `AQI: ${data.aqi || '--'}`,
							color: '#ffffff'
						};
						aqiElement.textContent = aqiInfo.text;
						aqiElement.style.color = aqiInfo.color;
					}
					// å¦‚æœæ²¡æœ‰air_qualityå­—æ®µï¼Œä½†æœ‰aqiå­—æ®µï¼Œåˆ™ä½¿ç”¨aqiæ•°å€¼
					else if (data.aqi) {
						aqiElement.textContent = `AQI: ${data.aqi}`;
						aqiElement.style.color = getAqiColor(data.aqi);
					}
					// å¦‚æœéƒ½æ²¡æœ‰ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼
					else {
						aqiElement.textContent = 'AQI: --';
					}
				}

				if (pmElement && data.pm25) {
					pmElement.textContent = `PM2.5: ${data.pm25}`;
				}
			}

			// æ ¹æ®å¤©æ°”çŠ¶å†µè¿”å›å¯¹åº”çš„å›¾æ ‡
			function getWeatherIcon(weather) {
				return weatherIcons[weather] || 'ğŸŒ¤ï¸';
			}

			// æ ¹æ®AQIå€¼è¿”å›å¯¹åº”çš„é¢œè‰²
			function getAqiColor(aqi) {
				if (aqi <= 50) return '#00e400'; // ä¼˜
				if (aqi <= 100) return '#ffff00'; // è‰¯
				if (aqi <= 150) return '#ff7e00'; // è½»åº¦æ±¡æŸ“
				if (aqi <= 200) return '#ff0000'; // ä¸­åº¦æ±¡æŸ“
				if (aqi <= 300) return '#99004c'; // é‡åº¦æ±¡æŸ“
				return '#7e0023'; // ä¸¥é‡æ±¡æŸ“
			}

			// å®šæœŸæ›´æ–°æ•°æ®
			async function startDataPolling() {
				// æ›´æ–°æ‰€æœ‰åŸå¸‚æ•°æ®
				for (const [cityPinyin, cityInfo] of Object.entries(capitalCities)) {
					try {
						const weatherData = await fetchWeatherData(cityPinyin);
						if (weatherData) {
							updateCityWeather(cityPinyin, weatherData);
						} else {
							// å¦‚æœAPIä¸å¯ç”¨ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
							const simulatedData = generateSimulatedData(cityInfo.name);
							updateCityWeather(cityPinyin, simulatedData);
						}
					} catch (error) {
						console.error(`æ›´æ–°${cityInfo.name}å¤©æ°”æ•°æ®å¤±è´¥:`, error);
						// ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåå¤‡
						const simulatedData = generateSimulatedData(cityInfo.name);
						updateCityWeather(cityPinyin, simulatedData);
					}

					// æ·»åŠ å°å»¶è¿Ÿï¼Œé¿å…åŒæ—¶å‘èµ·å¤§é‡è¯·æ±‚
					await new Promise(resolve => setTimeout(resolve, 100));
				}

				// è®¾ç½®å®šæ—¶å™¨ï¼Œæ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
				setTimeout(startDataPolling, 5 * 60 * 1000);
			}

			// ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼ˆå½“APIä¸å¯ç”¨æ—¶ä½¿ç”¨ï¼‰
			function generateSimulatedData(cityName) {
				const baseTemps = {
					'åŒ—äº¬': 28,
					'ä¸Šæµ·': 30,
					'å¹¿å·': 32,
					'æˆéƒ½': 26,
					'å“ˆå°”æ»¨': 22,
					'æµ·å£': 34,
					'æ˜†æ˜': 24,
					'ä¹Œé²æœ¨é½': 20
				};

				const weatherTypes = ['æ™´', 'å¤šäº‘', 'é˜´', 'å°é›¨', 'ä¸­é›¨', 'å¤§é›¨', 'é›·é˜µé›¨', 'é›ª'];
				const windDirections = ['åŒ—é£', 'ä¸œåŒ—é£', 'ä¸œé£', 'ä¸œå—é£', 'å—é£', 'è¥¿å—é£', 'è¥¿é£', 'è¥¿åŒ—é£'];
				const aqiLevels = ['ä¼˜', 'è‰¯', 'è½»åº¦æ±¡æŸ“', 'ä¸­åº¦æ±¡æŸ“'];

				return {
					current_temp: baseTemps[cityName] || 25 + Math.floor(Math.random() * 10),
					weather: weatherTypes[Math.floor(Math.random() * weatherTypes.length)],
					humidity: Math.floor(40 + Math.random() * 40) + '%',
					wind_direction: windDirections[Math.floor(Math.random() * windDirections.length)],
					wind_level: (1 + Math.floor(Math.random() * 5)) + 'çº§',
					aqi: Math.floor(20 + Math.random() * 100),
					pm25: Math.floor(10 + Math.random() * 20)
				};
			}

			// åˆå§‹åŒ–æ»šåŠ¨å¤„ç†
			function initScrollHandler() {
				const container = document.querySelector('.city-weather-container');
				const progress = document.getElementById('scroll-progress');

				if (!container || !progress) return;

				container.addEventListener('scroll', function() {
					const scrollWidth = container.scrollWidth - container.clientWidth;
					const scrollLeft = container.scrollLeft;
					const progressPercent = (scrollLeft / scrollWidth) * 100;

					progress.style.width = progressPercent + '%';
				}, {
					passive: true
				});
			}

			// çŠ¶æ€æ›´æ–°å‡½æ•°
			function updateStatus(message) {
				const statusElement = document.getElementById('status-text');
				if (statusElement) {
					statusElement.textContent = `ç³»ç»ŸçŠ¶æ€: ${message}`;
				}
			}

			// å®‰å…¨è·å–å…ƒç´ å‡½æ•°
			function getElementSafe(id) {
				const element = document.getElementById(id);
				if (!element) {
					console.warn(`å…ƒç´  ${id} ä¸å­˜åœ¨`);
				}
				return element;
			}

			// ä»APIè·å–å¤©æ°”æ•°æ®
			async function fetchWeatherData(city) {
				try {
					const response = await fetch(`${API_BASE}/weather/${city}`);
					if (!response.ok) throw new Error('ç½‘ç»œå“åº”ä¸æ­£å¸¸');
					return await response.json();
				} catch (error) {
					console.error(`è·å–${city}å¤©æ°”æ•°æ®å¤±è´¥:`, error);
					return null;
				}
			}

			// è·å–é£åœºæ•°æ®
			async function fetchWindData() {
				try {
					const response = await fetch(`${API_BASE}/wind-data`);
					if (!response.ok) throw new Error('ç½‘ç»œå“åº”ä¸æ­£å¸¸');
					const data = await response.json();

					// ç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®
					if (data && data.points && Array.isArray(data.points)) {
						return data;
					} else {
						throw new Error('é£åœºæ•°æ®æ ¼å¼ä¸æ­£ç¡®');
					}
				} catch (error) {
					console.error('è·å–é£åœºæ•°æ®å¤±è´¥:', error);
					return null;
				}
			}

			// æ›´æ–°é£åœºå¯è§†åŒ–
			function updateWindVisualization(windData) {
				if (!windyChart) return;

				// å¤„ç†æ•°æ®
				const processedData = processWindyData(windData);

				// æ›´æ–°å›¾è¡¨é€‰é¡¹
				const option = windyChart.getOption();
				option.series[0].data = processedData;

				// é‡æ–°è®¾ç½®é€‰é¡¹
				windyChart.setOption(option);

				// æ›´æ–°çŠ¶æ€æ˜¾ç¤º
				updateStatus('é£åœºæ•°æ®å·²æ›´æ–°');
			}

			// å¤„ç†é£åœºæ•°æ®æ ¼å¼
			function processWindyData(windData) {
				const processedData = [];

				// å¤„ç†APIè¿”å›çš„å®é™…æ•°æ®
				if (windData && windData.points) {
					windData.points.forEach(point => {
						processedData.push([
							point.lon,
							point.lat,
							point.u,
							point.v,
							point.speed,
							point.temp
						]);
					});
				}

				return processedData;
			}

			// æ›´æ–°æ•°æ®çŠ¶æ€æ˜¾ç¤º
			function updateDataStatus(message, isError = false) {
				const statusElement = document.getElementById('data-status');
				if (statusElement) {
					statusElement.innerHTML = isError ?
						`<p style="color: #ff6b6b;">${message}</p><button class="retry-button" id="retry-button">é‡è¯•åŠ è½½æ•°æ®</button>` :
						`<p>${message}</p>`;

					if (isError) {
						const retryButton = document.getElementById('retry-button');
						retryButton.addEventListener('click', startDataPolling);
					}
				}
			}

			// åŠ è½½èµ„æº
			async function loadResources() {
				updateStatus('æ­£åœ¨åŠ è½½åœ°å›¾æ•°æ®...');

				try {
					// åŠ è½½ä¸­å›½åœ°å›¾GeoJSON
					const chinaResponse = await fetch('https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json');
					if (!chinaResponse.ok) throw new Error('åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥');
					chinaGeoJson = await chinaResponse.json();

					// ç¡®ä¿åœ°å›¾æ•°æ®æœ‰æ•ˆ
					if (!chinaGeoJson || !chinaGeoJson.features || chinaGeoJson.features.length === 0) {
						throw new Error('åœ°å›¾æ•°æ®æ ¼å¼æ— æ•ˆ');
					}

					// æ³¨å†Œåœ°å›¾
					echarts.registerMap('china', chinaGeoJson);

					updateStatus('æ­£åœ¨åŠ è½½å¤©æ°”æ•°æ®...');

					// åŠ è½½å¤©æ°”æ•°æ®
					await loadWeatherData();

					// åŠ è½½é£åœºæ•°æ®
					const windData = await fetchWindData();
					if (windData) {
						updateWindVisualization(windData);
						updateStatus('é£åœºæ•°æ®åŠ è½½å®Œæˆ');
					} else {
						throw new Error('é£åœºæ•°æ®åŠ è½½å¤±è´¥');
					}

					updateStatus('èµ„æºåŠ è½½å®Œæˆ');

					// åœ¨å¤„ç†å®Œå¤©æ°”æ•°æ®åï¼Œä¿å­˜åˆ°localStorage
					localStorage.setItem('allWeatherData', JSON.stringify(weatherData));

					// åˆå§‹åŒ–å›¾è¡¨
					initWindyChart();

					// åˆå§‹åŒ–åŸå¸‚å›¾è¡¨
					initCityCharts();

					// åˆå§‹åŒ–æ•°æ®åˆ†æå›¾è¡¨
					initDataCharts();

					// éšè—åŠ è½½å±‚
					const loadingOverlay = document.getElementById('loading-overlay');
					if (loadingOverlay) {
						loadingOverlay.style.opacity = '0';
						setTimeout(() => {
							loadingOverlay.style.display = 'none';
						}, 500);
					}

				} catch (error) {
					console.error('èµ„æºåŠ è½½å¤±è´¥:', error);
					updateStatus(`åŠ è½½å¤±è´¥: ${error.message}`);

					// ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåå¤‡
					setTimeout(() => {
						initWindyChart();
					}, 2000);
				}
			}

			// åŠ è½½å¤©æ°”æ•°æ®
			async function loadWeatherData() {
				const dataLoadPromises = [];

				for (const [cityPinyin, cityInfo] of Object.entries(capitalCities)) {
					dataLoadPromises.push(
						fetchWeatherData(cityPinyin)
						.then(data => {
							if (data) {
								weatherData[cityPinyin] = {
									name: cityInfo.name,
									coordinates: cityInfo.coordinates,
									data: data
								};
							} else {
								// ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåå¤‡
								console.warn(`ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸º${cityInfo.name}çš„åå¤‡`);
								weatherData[cityPinyin] = {
									name: cityInfo.name,
									coordinates: cityInfo.coordinates,
									data: generateSimulatedData(cityInfo.name)
								};
							}
						})
						.catch(error => {
							console.error(`åŠ è½½ ${cityInfo.name} æ•°æ®å¤±è´¥:`, error);
							// ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåå¤‡
							weatherData[cityPinyin] = {
								name: cityInfo.name,
								coordinates: cityInfo.coordinates,
								data: generateSimulatedData(cityInfo.name)
							};
						})
					);
				}

				await Promise.allSettled(dataLoadPromises);
				console.log('å¤©æ°”æ•°æ®åŠ è½½å®Œæˆ', weatherData);
			}

			// åŠ è½½å†å²æ•°æ®å‡½æ•°
			async function loadHistoricalData() {
				updateStatus('æ­£åœ¨åŠ è½½å†å²æ•°æ®...');

				const dataLoadPromises = [];

				for (const [cityPinyin, cityInfo] of Object.entries(capitalCities)) {
					const promise = fetch(`data/${cityPinyin}.json`)
						.then(response => {
							if (!response.ok) {
								throw new Error(`ç½‘ç»œå“åº”ä¸æ­£å¸¸: ${response.status}`);
							}
							return response.json();
						})
						.then(data => {
							historicalData[cityPinyin] = {
								name: cityInfo.name,
								coordinates: cityInfo.coordinates,
								data: data
							};
							console.log(`${cityInfo.name}å†å²æ•°æ®åŠ è½½æˆåŠŸ`, data);
						})
						.catch(error => {
							console.error(`åŠ è½½ ${cityInfo.name} å†å²æ•°æ®å¤±è´¥:`, error);
							// ä½¿ç”¨æ¨¡æ‹Ÿå†å²æ•°æ®ä½œä¸ºåå¤‡
							historicalData[cityPinyin] = {
								name: cityInfo.name,
								coordinates: cityInfo.coordinates,
								data: generateSimulatedHistoricalData(cityInfo.name)
							};
						});

					dataLoadPromises.push(promise);
				}

				await Promise.allSettled(dataLoadPromises);
				console.log('å†å²æ•°æ®åŠ è½½å®Œæˆ', historicalData);

				// åˆå§‹åŒ–æ•°æ®åˆ†æå›¾è¡¨
				initDataCharts();
			}

			// å®šæœŸæ›´æ–°é£åœºæ•°æ®
			async function updateWindDataPeriodically() {
				try {
					const windData = await fetchWindData();
					if (windData) {
						updateWindVisualization(windData);
					}
				} catch (error) {
					console.error('æ›´æ–°é£åœºæ•°æ®å¤±è´¥:', error);
				}

				// æ¯10åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
				setTimeout(updateWindDataPeriodically, 10 * 60 * 1000);
			}

			// ç”Ÿæˆæ¨¡æ‹Ÿå†å²æ•°æ®
			function generateSimulatedHistoricalData(cityName) {
				const data = [];
				const startDate = new Date(2020, 0, 1);

				for (let i = 0; i < 365 * 3; i++) { // 3å¹´çš„æ•°æ®
					const currentDate = new Date(startDate);
					currentDate.setDate(startDate.getDate() + i);

					const dateStr = currentDate.toISOString().split('T')[0];
					const weekDays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
					const weekDay = weekDays[currentDate.getDay()];

					// æ ¹æ®åŸå¸‚å’Œå­£èŠ‚ç”Ÿæˆä¸åŒçš„æ¸©åº¦
					let baseTemp = 15;
					if (cityName.includes('åŒ—äº¬') || cityName.includes('å“ˆå°”æ»¨')) {
						baseTemp = 10;
					} else if (cityName.includes('å¹¿å·') || cityName.includes('æµ·å£')) {
						baseTemp = 25;
					}

					// å­£èŠ‚å½±å“
					const month = currentDate.getMonth();
					let seasonalEffect = 0;
					if (month >= 2 && month <= 4) { // æ˜¥å­£
						seasonalEffect = 5;
					} else if (month >= 5 && month <= 7) { // å¤å­£
						seasonalEffect = 15;
					} else if (month >= 8 && month <= 10) { // ç§‹å­£
						seasonalEffect = 5;
					} else { // å†¬å­£
						seasonalEffect = -5;
					}

					const highTemp = Math.round(baseTemp + seasonalEffect + (Math.random() * 10 - 5));
					const lowTemp = Math.round(highTemp - 5 - Math.random() * 5);

					const weatherTypes = ['æ™´', 'å¤šäº‘', 'é˜´', 'å°é›¨', 'ä¸­é›¨', 'å¤§é›¨', 'é›ª'];
					const weather = weatherTypes[Math.floor(Math.random() * weatherTypes.length)];

					const windDirections = ['åŒ—é£', 'ä¸œåŒ—é£', 'ä¸œé£', 'ä¸œå—é£', 'å—é£', 'è¥¿å—é£', 'è¥¿é£', 'è¥¿åŒ—é£'];
					const windDirection = windDirections[Math.floor(Math.random() * windDirections.length)];
					const windLevel = Math.floor(Math.random() * 5) + 1;

					data.push({
						"æ—¥æœŸ": `${dateStr} ${weekDay}`,
						"æœ€é«˜æ¸©": `${highTemp}â„ƒ`,
						"æœ€ä½æ¸©": `${lowTemp}â„ƒ`,
						"å¤©æ°”": weather,
						"é£å‘é£åŠ›": `${windDirection} ${windLevel}çº§`
					});
				}

				return data;
			}

			// å¤„ç†æ¸©åº¦æ•°æ®ï¼Œä»å­—ç¬¦ä¸²ä¸­æå–æ•°å­—
			function parseTemperature(tempStr) {
				if (!tempStr) return null;
				const match = tempStr.match(/(-?\d+)â„ƒ/);
				return match ? parseInt(match[1]) : null;
			}

			// è®¡ç®—åŸå¸‚å¹´å¹³å‡æ°”æ¸©
			function calculateYearlyAverageTemperatures(cityData) {
				const yearlyTemps = {};

				cityData.data.forEach(day => {
					const datePart = day.æ—¥æœŸ.split(' ')[0]; // è·å–æ—¥æœŸéƒ¨åˆ†
					const date = new Date(datePart);
					// æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
					if (isNaN(date.getTime())) {
						console.warn('æ— æ•ˆæ—¥æœŸ:', day.æ—¥æœŸ);
						return;
					}

					const year = date.getFullYear();

					if (!yearlyTemps[year]) {
						yearlyTemps[year] = {
							sum: 0,
							count: 0
						};
					}

					const highTemp = parseTemperature(day.æœ€é«˜æ¸©);
					const lowTemp = parseTemperature(day.æœ€ä½æ¸©);

					if (highTemp !== null && lowTemp !== null) {
						const avgTemp = (highTemp + lowTemp) / 2;
						yearlyTemps[year].sum += avgTemp;
						yearlyTemps[year].count++;
					}
				});

				const result = {};
				for (const [year, data] of Object.entries(yearlyTemps)) {
					if (data.count > 0) {
						result[year] = data.sum / data.count;
					}
				}

				return result;
			}

			// è®¡ç®—å¤©æ°”æƒ…å†µåˆ†å¸ƒ
			function calculateWeatherDistribution(cityData) {
				const weatherCount = {};
				let totalDays = 0;

				cityData.data.forEach(day => {
					if (day.å¤©æ°”) {
						// å¤„ç†å¤åˆå¤©æ°”æƒ…å†µï¼Œå¦‚"æ™´è½¬å¤šäº‘"
						const weathers = day.å¤©æ°”.split(/è½¬|åˆ°|,/);
						weathers.forEach(weather => {
							const trimmedWeather = weather.trim();
							if (trimmedWeather) {
								weatherCount[trimmedWeather] = (weatherCount[trimmedWeather] || 0) + 1;
								totalDays++;
							}
						});
					}
				});

				// è½¬æ¢ä¸ºç™¾åˆ†æ¯”
				const result = {};
				for (const [weather, count] of Object.entries(weatherCount)) {
					result[weather] = (count / totalDays) * 100;
				}

				return result;
			}

			// åˆå§‹åŒ–æ•°æ®åˆ†æå›¾è¡¨
			function initDataCharts() {
				// æ¸…é™¤åŠ è½½çŠ¶æ€æç¤º
				document.querySelectorAll('.data-loading').forEach(el => {
					el.remove();
				});

				// å¹´å¹³å‡æ°”æ¸©æŸ±çŠ¶å›¾
				initTempChart();

				// å¤©æ°”æƒ…å†µåˆ†å¸ƒå›¾
				initWeatherChart();

				// é£é€Ÿé£å‘å›¾
				initWindChart();

				updateStatus('æ•°æ®åˆ†æå›¾è¡¨åˆå§‹åŒ–å®Œæˆ');
			}

			function initTempChart() {
				const chartDom = getElementSafe('temp-chart');
				if (!chartDom) {
					console.warn('æ— æ³•æ‰¾åˆ°temp-chartå…ƒç´ ');
					return;
				}

				const chart = echarts.init(chartDom);

				// é€‰æ‹©è¦æ˜¾ç¤ºçš„å°‘æ•°åŸå¸‚
				const selectedCities = ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æˆéƒ½'];
				const cityData = [];
				const temperatures = [];

				// ä»å†å²æ•°æ®ä¸­æå–é€‰å®šåŸå¸‚çš„æ¸©åº¦æ•°æ®
				selectedCities.forEach(cityName => {
					// æŸ¥æ‰¾å¯¹åº”çš„åŸå¸‚æ•°æ®
					for (const [cityPinyin, cityInfo] of Object.entries(historicalData)) {
						if (cityInfo.name === cityName) {
							const yearlyTemps = calculateYearlyAverageTemperatures(cityInfo);

							// è·å–æœ€è¿‘ä¸€å¹´çš„æ¸©åº¦æ•°æ®
							const years = Object.keys(yearlyTemps).sort();
							if (years.length > 0) {
								const latestYear = years[years.length - 1];
								cityData.push({
									name: cityName,
									temperature: yearlyTemps[latestYear]
								});
							}
							break;
						}
					}
				});

				// å‡†å¤‡å›¾è¡¨æ•°æ®
				const cityNames = cityData.map(item => item.name);
				const tempValues = cityData.map(item => item.temperature ? item.temperature.toFixed(1) : 0);

				const option = {
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'shadow'
						},
						formatter: function(params) {
							return `${params[0].name}<br/>å¹³å‡æ°”æ¸©: ${params[0].value}Â°C`;
						}
					},
					grid: {
						left: '3%',
						right: '4%',
						bottom: '3%',
						top: '10%',
						containLabel: true
					},
					xAxis: {
						type: 'category',
						data: cityNames,
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						axisLabel: {
							color: '#aaccff',
							interval: 0,
							rotate: 0 // å¯ä»¥æ ¹æ®åŸå¸‚åç§°é•¿åº¦è°ƒæ•´æ—‹è½¬è§’åº¦
						}
					},
					yAxis: {
						type: 'value',
						name: 'æ¸©åº¦ Â°C',
						nameTextStyle: {
							color: '#aaccff'
						},
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						splitLine: {
							lineStyle: {
								color: 'rgba(91, 192, 222, 0.1)'
							}
						},
						axisLabel: {
							color: '#aaccff',
							formatter: '{value}Â°C'
						}
					},
					series: [{
						name: 'å¹´å¹³å‡æ°”æ¸©',
						type: 'bar',
						data: tempValues,
						itemStyle: {
							color: function(params) {
								// æ ¹æ®æ¸©åº¦å€¼è®¾ç½®é¢œè‰²
								const temp = params.value;
								if (temp < 0) return '#313695';
								if (temp < 10) return '#4575b4';
								if (temp < 20) return '#74add1';
								if (temp < 25) return '#abd9e9';
								if (temp < 30) return '#ffffbf';
								if (temp < 35) return '#fee090';
								return '#f46d43';
							}
						},
						label: {
							show: true,
							position: 'top',
							color: '#e0f0ff',
							formatter: '{c}Â°C'
						}
					}]
				};

				chart.setOption(option);

				// æ·»åŠ ç‚¹å‡»äº‹ä»¶ - ç‚¹å‡»å›¾è¡¨è·³è½¬åˆ°è¯¦ç»†é¡µé¢
				chart.on('click', function() {
					// å­˜å‚¨å…¨éƒ¨åŸå¸‚æ¸©åº¦æ•°æ®åˆ°localStorageï¼Œä»¥ä¾¿æ–°é¡µé¢ä½¿ç”¨
					const allCityTemps = {};
					for (const [cityPinyin, cityInfo] of Object.entries(historicalData)) {
						const yearlyTemps = calculateYearlyAverageTemperatures(cityInfo);
						const years = Object.keys(yearlyTemps).sort();
						if (years.length > 0) {
							const latestYear = years[years.length - 1];
							allCityTemps[cityInfo.name] = yearlyTemps[latestYear];
						}
					}

					localStorage.setItem('allCityTemperatures', JSON.stringify(allCityTemps));
					window.open('temperature-comparison.html', '_blank');
				});

				// æ·»åŠ å“åº”å¼å¤„ç†
				window.addEventListener('resize', function() {
					chart.resize();
				}, {
					passive: true
				});

				// ä¸ºæŸ¥çœ‹å…¨éƒ¨æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
				const temperatureLink = document.getElementById('temperature-link');
				if (temperatureLink) {
					temperatureLink.addEventListener('click', function(e) {
						e.preventDefault();

						// å­˜å‚¨å…¨éƒ¨åŸå¸‚æ¸©åº¦æ•°æ®åˆ°localStorage
						const allCityTemps = {};
						for (const [cityPinyin, cityInfo] of Object.entries(historicalData)) {
							const yearlyTemps = calculateYearlyAverageTemperatures(cityInfo);
							const years = Object.keys(yearlyTemps).sort();
							if (years.length > 0) {
								const latestYear = years[years.length - 1];
								allCityTemps[cityInfo.name] = yearlyTemps[latestYear];
							}
						}

						localStorage.setItem('allCityTemperatures', JSON.stringify(allCityTemps));
						// ä¿®æ”¹ä¸ºè·³è½¬åˆ°wind-rose.htmlå¹¶ä¼ é€’å‚æ•°
						window.open('wind-rose.html?chart=temperature', '_blank');
					});
				}
			}

			// æå–æ¸²æŸ“å›¾è¡¨çš„å…¬å…±ä»£ç 
			function renderTemperatureChart(chart, yearData, years) {
				// è®¡ç®—æ¸©åº¦èŒƒå›´ç”¨äºè§†è§‰æ˜ å°„
				const allTemps = [];
				Object.values(yearData).forEach(data => {
					data.forEach(item => {
						if (item.value && item.value.length > 2) {
							allTemps.push(item.value[2]);
						}
					});
				});

				const minTemp = Math.min(...allTemps);
				const maxTemp = Math.max(...allTemps);

				const option = {
					tooltip: {
						trigger: 'item',
						formatter: function(params) {
							if (!params.data || !params.data.value) {
								return 'æ— æ•°æ®';
							}
							return `${params.data.name}<br/>å¹´å¹³å‡æ°”æ¸©: ${params.data.value[2].toFixed(1)}Â°C`;
						}
					},
					visualMap: {
						min: minTemp - 2,
						max: maxTemp + 2,
						calculable: true,
						inRange: {
							color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61',
								'#f46d43', '#d73027', '#a50026'
							]
						},
						textStyle: {
							color: '#e0f0ff'
						},
						left: 'left',
						bottom: '10%',
						orient: 'vertical',
						backgroundColor: 'rgba(15, 40, 65, 0.7)',
						borderColor: 'rgba(91, 192, 222, 0.4)'
					},
					geo: {
						map: 'china',
						roam: true,
						zoom: 1.2,
						label: {
							emphasis: {
								show: true,
								color: '#ffffff'
							}
						},
						itemStyle: {
							areaColor: 'rgba(20, 40, 80, 0.6)',
							borderColor: '#3a6990',
							borderWidth: 1.5
						},
						emphasis: {
							itemStyle: {
								areaColor: 'rgba(40, 100, 180, 0.7)'
							}
						}
					},
					series: years.map(year => ({
						name: `${year}å¹´å¹³å‡æ°”æ¸©`,
						type: 'scatter',
						coordinateSystem: 'geo',
						data: yearData[year],
						symbolSize: function(val) {
							if (!val || val.length < 3) return 8;
							return Math.max(8, Math.min(20, (val[2] - 10) * 0.5));
						},
						encode: {
							value: 2
						},
						itemStyle: {
							color: function(params) {
								if (!params.data || !params.data.value || params.data.value.length < 3) {
									return '#4575b4';
								}
								const temp = params.data.value[2];
								if (temp < 0) return '#313695';
								if (temp < 10) return '#4575b4';
								if (temp < 20) return '#74add1';
								if (temp < 25) return '#abd9e9';
								if (temp < 30) return '#ffffbf';
								if (temp < 35) return '#fee090';
								return '#f46d43';
							}
						}
					}))
				};

				chart.setOption(option);

				// æ·»åŠ å“åº”å¼å¤„ç†
				window.addEventListener('resize', function() {
					chart.resize();
				}, {
					passive: true
				});
			}

			// åˆå§‹åŒ–Windyå›¾è¡¨
			function initWindyChart() {
				const chartDom = document.getElementById('windy-map');
				if (!chartDom) {
					console.error('æ— æ³•æ‰¾åˆ°windy-mapå…ƒç´ ');
					return;
				}

				windyChart = echarts.init(chartDom);

				// åˆ›å»ºåˆå§‹é€‰é¡¹
				const option = createWindyChartOption();
				windyChart.setOption(option);

				// å“åº”çª—å£å¤§å°å˜åŒ–
				window.addEventListener('resize', function() {
					windyChart.resize();
				}, {
					passive: true
				});

				updateStatus('é£åœºæ•°æ®åŠ è½½å®Œæˆ');

				// æ¨¡æ‹Ÿæ•°æ®æ›´æ–°
				setInterval(() => {
					const windValue = getElementSafe('wind-value');
					if (windValue) {
						const windSpeed = (Math.random() * 15 + 5).toFixed(1);
						windValue.textContent = `${windSpeed} km/h`;
					}
				}, 5000);

				// å¯åŠ¨å®šæœŸæ›´æ–°
				updateWindDataPeriodically();
			}

			// åˆ›å»ºWindyå›¾è¡¨é€‰é¡¹
			function createWindyChartOption() {
				const isWindMode = currentMode === 'wind';
				const isTempMode = currentMode === 'temp';
				const isRainMode = currentMode === 'rain';

				// ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
				const windData = generateWindData();
				const tempData = generateTempData();
				const rainData = generateRainData();

				// ç¡®ä¿åœ°å›¾æ•°æ®å­˜åœ¨
				let mapOption = {};
				if (chinaGeoJson && chinaGeoJson.features && chinaGeoJson.features.length > 0) {
					mapOption = {
						map: 'china',
						roam: true,
						zoom: 3,
						center: [105, 36],
						label: {
							emphasis: {
								show: true,
								color: '#ffffff'
							}
						},
						itemStyle: {
							areaColor: {
								type: 'linear-gradient',
								x: 0,
								y: 0,
								x2: 0,
								y2: 1,
								colorStops: [{
									offset: 0,
									color: 'rgba(20, 40, 80, 0.6)'
								}, {
									offset: 1,
									color: 'rgba(10, 30, 60, 0.8)'
								}]
							},
							borderColor: '#3a6990',
							borderWidth: 1.5
						},
						emphasis: {
							itemStyle: {
								areaColor: 'rgba(40, 100, 180, 0.7)'
							}
						}
					};
				} else {
					// ä½¿ç”¨ä¸–ç•Œåœ°å›¾ä½œä¸ºå¤‡é€‰
					mapOption = {
						map: 'world',
						roam: true,
						zoom: 3,
						center: [105, 36],
						itemStyle: {
							areaColor: 'rgba(20, 40, 80, 0.6)',
							borderColor: '#3a6990',
							borderWidth: 1.5
						}
					};
				}

				return {
					backgroundColor: 'transparent',
					tooltip: {
						trigger: 'item',
						backgroundColor: 'rgba(10, 25, 40, 0.9)',
						borderColor: 'rgba(91, 192, 222, 0.5)',
						textStyle: {
							color: '#e0f0ff',
							fontSize: 14
						},
						formatter: function(params) {
							if (params.seriesType === 'custom') {
								const value = params.value;
								return `
                                <div style="margin: 5px 0; font-weight: bold; color: #5bc0de;">ä½ç½®ä¿¡æ¯</div>
                                <div>ç»åº¦: ${value[0].toFixed(2)}Â°E</div>
                                <div>çº¬åº¦: ${value[1].toFixed(2)}Â°N</div>
                                <div style="margin-top: 10px; font-weight: bold; color: #ffcc00;">æ°”è±¡æ•°æ®</div>
                                <div>é£é€Ÿ: <span style="color: #f46d43;">${value[4].toFixed(1)} km/h</span></div>
                                <div>æ¸©åº¦: <span style="color: #ff9900;">${value[5].toFixed(1)}Â°C</span></div>
                            `;
							} else if (params.seriesType === 'scatter') {
								return `é™é›¨å¼ºåº¦: ${(params.value[2] * 100).toFixed(0)}%`;
							} else if (params.seriesType === 'heatmap') {
								return `æ¸©åº¦: ${params.value[2]}Â°C`;
							}
						}
					},
					visualMap: [{
						show: true,
						min: isWindMode ? 0 : 10,
						max: isWindMode ? 40 : 38,
						dimension: isWindMode ? 4 : 2,
						calculable: true,
						inRange: {
							color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090',
								'#fdae61', '#f46d43', '#d73027', '#a50026'
							]
						},
						textStyle: {
							color: '#e0f0ff'
						},
						left: 'left',
						bottom: '10%',
						orient: 'vertical',
						backgroundColor: 'rgba(15, 40, 65, 0.7)',
						borderColor: 'rgba(91, 192, 222, 0.4)'
					}],
					geo: mapOption,
					series: [
						// é£åœºç²’å­æµ
						{
							type: 'custom',
							coordinateSystem: 'geo',
							renderItem: renderWindParticle,
							data: windData,
							progressive: 1000,
							blendMode: 'lighter',
							zlevel: 10,
							itemStyle: {
								opacity: isWindMode ? 0.9 : 0.3
							}
						},
						// æ¸©åº¦çƒ­åŠ›å›¾
						{
							type: 'heatmap',
							coordinateSystem: 'geo',
							data: tempData,
							pointSize: 12,
							blurSize: 18,
							zlevel: 1,
							visualMapIndex: 0,
							itemStyle: {
								opacity: isTempMode ? 0.7 : 0.3
							}
						},
						// é™æ°´æ•°æ®
						{
							type: 'scatter',
							coordinateSystem: 'geo',
							symbol: 'circle',
							symbolSize: function(val) {
								return Math.min(35, Math.max(6, val[2] * 50));
							},
							data: rainData,
							zlevel: 5,
							itemStyle: {
								color: function(params) {
									const intensity = params.value[2];
									return `rgba(65, 105, 225, ${intensity * 0.8})`;
								},
								opacity: isRainMode ? 0.8 : 0.2
							}
						}
					]
				};
			}

			// ç”Ÿæˆé£åœºæ•°æ®
			function generateWindData() {
				const data = [];
				const gridSize = 50;
				const lonMin = 70;
				const lonMax = 140;
				const latMin = 15;
				const latMax = 55;

				// æ¨¡æ‹Ÿä¸€ä¸ªå°é£ç³»ç»Ÿ
				const typhoonLon = 122;
				const typhoonLat = 28;
				const typhoonRadius = 15;

				for (let i = 0; i < gridSize; i++) {
					for (let j = 0; j < gridSize; j++) {
						const lon = lonMin + (lonMax - lonMin) * i / (gridSize - 1);
						const lat = latMin + (latMax - latMin) * j / (gridSize - 1);

						// è®¡ç®—åˆ°å°é£ä¸­å¿ƒçš„è·ç¦»
						const distanceToTyphoon = Math.sqrt(
							Math.pow(lon - typhoonLon, 2) + Math.pow(lat - typhoonLat, 2)
						);

						let u, v, speed;

						if (distanceToTyphoon < typhoonRadius) {
							// å°é£åŒºåŸŸ - å¼ºé£
							speed = 15 + 30 * (1 - distanceToTyphoon / typhoonRadius);

							// å°é£æ—‹è½¬æ–¹å‘ (é€†æ—¶é’ˆ)
							const angle = Math.atan2(lat - typhoonLat, lon - typhoonLon);
							u = -Math.sin(angle) * speed;
							v = Math.cos(angle) * speed;
						} else {
							// æ­£å¸¸åŒºåŸŸ
							speed = 5 + 12 * Math.sin(lon / 12) * Math.cos(lat / 10) + Math.random() * 3;

							// æ¨¡æ‹Ÿä¸»è¦é£å‘ (è¥¿é£å¸¦)
							u = -speed * 0.9;
							v = speed * 0.3 * Math.sin(lon / 15);
						}

						// æ·»åŠ æ¸©åº¦æ•°æ®
						const temp = 30 - Math.abs(lat - 35) * 0.7 + Math.sin(lon * 0.1) * 3;

						data.push([lon, lat, u, v, speed, temp]);
					}
				}

				return data;
			}

			// ç”Ÿæˆæ¸©åº¦æ•°æ®
			function generateTempData() {
				const data = [];
				const gridSize = 60;
				const lonMin = 70;
				const lonMax = 140;
				const latMin = 15;
				const latMax = 55;

				for (let i = 0; i < gridSize; i++) {
					for (let j = 0; j < gridSize; j++) {
						const lon = lonMin + (lonMax - lonMin) * i / (gridSize - 1);
						const lat = latMin + (latMax - latMin) * j / (gridSize - 1);

						// æ¸©åº¦æ•°æ® - å—æ–¹çƒ­åŒ—æ–¹å†·
						const baseTemp = 30 - Math.abs(lat - 35) * 0.7;
						const variation = Math.sin(lon * 0.1) * 3 + Math.cos(lat * 0.15) * 2;
						const temp = baseTemp + variation;
						data.push([lon, lat, temp]);
					}
				}

				return data;
			}

			// ç”Ÿæˆé™æ°´æ•°æ®
			function generateRainData() {
				const data = [];

				// æ¨¡æ‹Ÿå‡ ä¸ªé™é›¨åŒºåŸŸ
				const rainAreas = [{
						lon: 115,
						lat: 30,
						radius: 8,
						intensity: 0.8
					},
					{
						lon: 125,
						lat: 35,
						radius: 5,
						intensity: 0.6
					},
					{
						lon: 105,
						lat: 25,
						radius: 6,
						intensity: 0.7
					},
					{
						lon: 95,
						lat: 40,
						radius: 7,
						intensity: 0.5
					}
				];

				for (const area of rainAreas) {
					for (let i = 0; i < 100; i++) {
						const angle = Math.random() * Math.PI * 2;
						const radius = Math.random() * area.radius;
						const lon = area.lon + Math.cos(angle) * radius;
						const lat = area.lat + Math.sin(angle) * radius;

						// é™é›¨å¼ºåº¦
						const intensity = area.intensity * (1 - radius / area.radius) * (0.8 + Math.random() * 0.4);

						data.push([lon, lat, intensity]);
					}
				}

				return data;
			}

			// æ¸²æŸ“é£åœºç²’å­
			function renderWindParticle(params, api) {
				const coord = api.coord([api.value(0), api.value(1)]);
				const u = api.value(2);
				const v = api.value(3);
				const speed = api.value(4);

				// ç¡®ä¿åæ ‡æœ‰æ•ˆ
				if (!coord || isNaN(coord[0]) || isNaN(coord[1])) {
					return;
				}

				// ç¡®ä¿è§†å£ä¿¡æ¯å­˜åœ¨
				if (!params.viewport || typeof params.viewport.width !== 'number') {
					return;
				}

				// è·³è¿‡å±å¹•å¤–çš„ç‚¹
				if (coord[0] < -100 || coord[0] > params.viewport.width + 100 ||
					coord[1] < -100 || coord[1] > params.viewport.height + 100) {
					return;
				}

				// é£é€Ÿå†³å®šç²’å­é•¿åº¦
				const length = Math.min(50, Math.max(10, speed * 1.5));

				// è®¡ç®—æ–¹å‘è§’åº¦
				const angle = Math.atan2(v, u);

				// é£é€Ÿå†³å®šé¢œè‰²
				const color = speed < 5 ? '#74add1' :
					speed < 10 ? '#abd9e9' :
					speed < 15 ? '#fee090' :
					speed < 25 ? '#fdae61' : '#f46d43';

				// åˆ›å»ºç²’å­è·¯å¾„
				const path = [
					['M', 0, 0],
					['L', length, 0]
				];

				return {
					type: 'path',
					shape: {
						path: path
					},
					rotation: angle,
					position: coord,
					style: {
						stroke: color,
						lineWidth: Math.min(5, Math.max(1.5, speed * 0.4)),
						opacity: api.style('opacity'),
						shadowBlur: speed > 20 ? 15 : 0,
						shadowColor: speed > 20 ? '#ff3300' : 'transparent'
					},
					z2: 100
				};
			}

			// åŸå¸‚å¤©æ°”å›¾è¡¨åˆå§‹åŒ–
			function initCityCharts() {
				const cities = ['beijing', 'shanghai', 'guangzhou', 'chengdu'];

				cities.forEach(city => {
					const chartDom = getElementSafe(`${city}-chart`);
					if (!chartDom) {
						console.warn(`æ— æ³•æ‰¾åˆ° ${city}-chart å…ƒç´ `);
						return;
					}

					const chart = echarts.init(chartDom);

					// æ¨¡æ‹Ÿ24å°æ—¶æ¸©åº¦æ•°æ®
					const hours = [];
					const temps = [];
					for (let i = 0; i < 24; i++) {
						hours.push(`${i}:00`);
						// æ ¹æ®ä¸åŒåŸå¸‚ç”Ÿæˆä¸åŒçš„æ¸©åº¦æ›²çº¿
						let baseTemp;
						switch (city) {
							case 'beijing':
								baseTemp = 25;
								break;
							case 'shanghai':
								baseTemp = 28;
								break;
							case 'guangzhou':
								baseTemp = 30;
								break;
							case 'chengdu':
								baseTemp = 26;
								break;
						}
						temps.push((baseTemp + Math.sin(i * Math.PI / 12) * 5 + Math.random() * 2).toFixed(1));
					}

					const option = {
						grid: {
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '10%',
							containLabel: true
						},
						tooltip: {
							trigger: 'axis'
						},
						xAxis: {
							type: 'category',
							data: hours,
							axisLine: {
								lineStyle: {
									color: '#5bc0de'
								}
							},
							axisLabel: {
								color: '#aaccff',
								interval: 3
							}
						},
						yAxis: {
							type: 'value',
							name: 'æ¸©åº¦ Â°C',
							nameTextStyle: {
								color: '#aaccff'
							},
							axisLine: {
								lineStyle: {
									color: '#5bc0de'
								}
							},
							splitLine: {
								lineStyle: {
									color: 'rgba(91, 192, 222, 0.1)'
								}
							},
							axisLabel: {
								color: '#aaccff'
							}
						},
						series: [{
							name: 'æ¸©åº¦',
							type: 'line',
							data: temps,
							smooth: true,
							symbol: 'circle',
							symbolSize: 6,
							lineStyle: {
								width: 3,
								color: '#ffcc00'
							},
							itemStyle: {
								color: '#ffcc00'
							},
							areaStyle: {
								color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: 'rgba(255, 204, 0, 0.3)'
									},
									{
										offset: 1,
										color: 'rgba(255, 204, 0, 0.05)'
									}
								])
							}
						}]
					};

					chart.setOption(option);

					// æ·»åŠ å“åº”å¼å¤„ç†
					window.addEventListener('resize', function() {
						chart.resize();
					}, {
						passive: true
					});
				});
			}

			// ä¿®æ”¹åçš„initWeatherChartå‡½æ•°
			function initWeatherChart() {
				const chartDom = getElementSafe('weather-chart');
				if (!chartDom) {
					console.warn('æ— æ³•æ‰¾åˆ°weather-chartå…ƒç´ ');
					return;
				}

				const chart = echarts.init(chartDom);

				// å¤„ç†æ•°æ®ï¼šè®¡ç®—æ¯ä¸ªåŸå¸‚çš„å¤©æ°”æƒ…å†µåˆ†å¸ƒ
				const cityWeatherData = {};

				for (const [cityPinyin, cityData] of Object.entries(historicalData)) {
					const weatherDistribution = calculateWeatherDistribution(cityData);
					cityWeatherData[cityData.name] = weatherDistribution;
				}

				// å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
				if (Object.keys(cityWeatherData).length === 0) {
					for (const [cityPinyin, cityInfo] of Object.entries(capitalCities)) {
						const weatherTypes = ['æ™´', 'å¤šäº‘', 'é˜´', 'å°é›¨', 'ä¸­é›¨', 'å¤§é›¨', 'é›ª'];
						const distribution = {};

						// ç”Ÿæˆéšæœºåˆ†å¸ƒ
						let remaining = 100;
						for (let i = 0; i < weatherTypes.length; i++) {
							if (i === weatherTypes.length - 1) {
								distribution[weatherTypes[i]] = remaining;
							} else {
								const value = Math.random() * remaining * 0.7;
								distribution[weatherTypes[i]] = value;
								remaining -= value;
							}
						}

						cityWeatherData[cityInfo.name] = distribution;
					}
				}

				// è·å–æ‰€æœ‰å¤©æ°”ç±»å‹å¹¶æŒ‰å‡ºç°é¢‘ç‡æ’åº
				const allWeatherTypes = new Set();
				Object.values(cityWeatherData).forEach(distribution => {
					Object.keys(distribution).forEach(weather => {
						allWeatherTypes.add(weather);
					});
				});

				// è®¡ç®—æ¯ç§å¤©æ°”ç±»å‹çš„æ€»å‡ºç°é¢‘ç‡
				const weatherFrequency = {};
				allWeatherTypes.forEach(weather => {
					weatherFrequency[weather] = 0;
					Object.values(cityWeatherData).forEach(distribution => {
						weatherFrequency[weather] += distribution[weather] || 0;
					});
				});

				// æŒ‰é¢‘ç‡æ’åºå¹¶é€‰æ‹©å‰5ç§ä¸»è¦å¤©æ°”ç±»å‹
				const sortedWeatherTypes = Array.from(allWeatherTypes).sort((a, b) => {
					return weatherFrequency[b] - weatherFrequency[a];
				});

				const mainWeatherTypes = sortedWeatherTypes.slice(0, 5);
				mainWeatherTypes.push('å…¶ä»–'); // æ·»åŠ "å…¶ä»–"ç±»åˆ«

				// é‡ç»„æ•°æ®ï¼Œå°†éä¸»è¦å¤©æ°”ç±»å‹åˆå¹¶åˆ°"å…¶ä»–"
				const processedCityData = {};
				Object.entries(cityWeatherData).forEach(([city, distribution]) => {
					processedCityData[city] = {};
					let otherPercentage = 0;

					Object.entries(distribution).forEach(([weather, percentage]) => {
						if (mainWeatherTypes.includes(weather)) {
							processedCityData[city][weather] = percentage;
						} else {
							otherPercentage += percentage;
						}
					});

					if (otherPercentage > 0) {
						processedCityData[city]['å…¶ä»–'] = otherPercentage;
					}

					// ç¡®ä¿æ‰€æœ‰ä¸»è¦å¤©æ°”ç±»å‹éƒ½æœ‰å€¼ï¼ˆå³ä½¿ä¸º0ï¼‰
					mainWeatherTypes.forEach(weather => {
						if (!processedCityData[city][weather]) {
							processedCityData[city][weather] = 0;
						}
					});
				});

				// ä¿®æ”¹ï¼šåªé€‰æ‹©4ä¸ªä¸»è¦åŸå¸‚å±•ç¤º
				const selectedCities = ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æˆéƒ½'];
				const seriesData = [];

				mainWeatherTypes.forEach(weather => {
					const data = selectedCities.map(city => {
						return processedCityData[city][weather] || 0;
					});

					seriesData.push({
						name: weather,
						type: 'bar',
						stack: 'æ€»é‡',
						data: data,
						emphasis: {
							focus: 'series'
						}
					});
				});

				const option = {
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'shadow'
						},
						formatter: function(params) {
							let result = params[0].name + '<br/>';
							let total = 0;

							params.forEach(param => {
								result += `${param.seriesName}: ${param.value.toFixed(1)}%<br/>`;
								total += param.value;
							});

							result += `<hr style="margin: 5px 0; border: none; border-top: 1px solid #ccc;"/>`;
							result += `æ€»è®¡: ${total.toFixed(1)}%`;

							return result;
						}
					},
					legend: {
						data: mainWeatherTypes,
						textStyle: {
							color: '#aaccff'
						},
						top: 10,
						right: 10,
						selectedMode: true, // å…è®¸é€‰æ‹©å›¾ä¾‹
						type: 'scroll' // å¦‚æœå›¾ä¾‹è¿‡å¤šï¼Œæ·»åŠ æ»šåŠ¨æ¡
					},
					grid: {
						left: '3%',
						right: '4%',
						bottom: '3%',
						top: '20%',
						containLabel: true
					},
					xAxis: {
						type: 'category',
						data: selectedCities,
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						axisLabel: {
							color: '#aaccff'
						}
					},
					yAxis: {
						type: 'value',
						name: 'å‡ºç°æ¦‚ç‡(%)',
						nameTextStyle: {
							color: '#aaccff'
						},
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						splitLine: {
							lineStyle: {
								color: 'rgba(91, 192, 222, 0.1)'
							}
						},
						axisLabel: {
							color: '#aaccff',
							formatter: '{value}%'
						}
					},
					series: seriesData
				};

				chart.setOption(option);

				// æ·»åŠ ç‚¹å‡»äº‹ä»¶
				chart.on('click', function() {
					// å­˜å‚¨æ•°æ®åˆ°localStorageï¼Œä»¥ä¾¿æ–°é¡µé¢ä½¿ç”¨
					localStorage.setItem('weatherDistributionData', JSON.stringify(cityWeatherData));
					// æ‰“å¼€æ–°é¡µé¢
					window.open('weather-distribution.html', '_blank');
				});

				// æ·»åŠ å›¾ä¾‹é€‰æ‹©å˜åŒ–äº‹ä»¶
				chart.on('legendselectchanged', function(params) {
					// å½“ç”¨æˆ·é€‰æ‹©/å–æ¶ˆé€‰æ‹©å›¾ä¾‹æ—¶ï¼Œå›¾è¡¨ä¼šè‡ªåŠ¨æ›´æ–°
				});

				// å“åº”çª—å£å¤§å°å˜åŒ–
				window.addEventListener('resize', function() {
					chart.resize();
				}, {
					passive: true
				});
			}

			function initWindChart() {
				const chartDom = document.getElementById('wind-chart');
				if (!chartDom) {
					console.warn('æ— æ³•æ‰¾åˆ°wind-chartå…ƒç´ ');
					return;
				}

				const chart = echarts.init(chartDom);

				// å¤„ç†æ•°æ®ï¼šä»åŒ—äº¬æ•°æ®ä¸­æå–é£å‘å’Œé£é€Ÿä¿¡æ¯
				const windData = processWindData('beijing');

				// å…«æ–¹å‘æ•°æ®
				const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
				const directionNames = ['åŒ—', 'ä¸œåŒ—', 'ä¸œ', 'ä¸œå—', 'å—', 'è¥¿å—', 'è¥¿', 'è¥¿åŒ—'];

				// å‡†å¤‡å›¾è¡¨æ•°æ®
				const windSpeedData = directions.map(dir => {
					return windData[dir] ? windData[dir].avgSpeed : 0;
				});

				const windFrequencyData = directions.map(dir => {
					return windData[dir] ? windData[dir].frequency : 0;
				});

				const option = {
					tooltip: {
						trigger: 'item',
						formatter: function(params) {
							const directionIndex = params.dataIndex;
							const direction = directionNames[directionIndex];
							const speed = windSpeedData[directionIndex];
							const frequency = windFrequencyData[directionIndex];
							return `${direction}é£<br/>å¹³å‡é£é€Ÿ: ${speed.toFixed(1)} km/h<br/>å‡ºç°é¢‘ç‡: ${frequency.toFixed(1)}%`;
						}
					},
					title: {
						text: '',
						left: 'center'
					},
					polar: {
						radius: '80%'
					},
					angleAxis: {
						type: 'category',
						data: directionNames, // ä½¿ç”¨ä¸­æ–‡æ–¹å‘åç§°æ˜¾ç¤º
						startAngle: 90,
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						axisLabel: {
							color: '#aaccff',
							fontSize: 14,
							fontWeight: 'bold'
						}
					},
					radiusAxis: {
						min: 0,
						axisLine: {
							lineStyle: {
								color: '#5bc0de'
							}
						},
						axisLabel: {
							color: '#aaccff',
							formatter: function(value) {
								return value.toFixed(0);
							},
							show: false // éšè—åŠå¾„è½´æ ‡ç­¾
						},
						splitLine: {
							lineStyle: {
								color: 'rgba(91, 192, 222, 0.1)'
							}
						}
					},
					series: [{
						name: 'é£é€Ÿä¸é£å‘',
						type: 'bar',
						coordinateSystem: 'polar',
						data: windSpeedData,
						itemStyle: {
							color: function(params) {
								// æ ¹æ®é£é€Ÿå€¼è®¾ç½®é¢œè‰²æ¸å˜
								const speed = params.value;
								if (speed < 5) return '#74add1';
								if (speed < 10) return '#abd9e9';
								if (speed < 15) return '#fee090';
								if (speed < 20) return '#fdae61';
								return '#f46d43';
							}
						},
						emphasis: {
							itemStyle: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)'
							}
						}
					}]
				};

				chart.setOption(option);

				// å“åº”çª—å£å¤§å°å˜åŒ–
				window.addEventListener('resize', function() {
					chart.resize();
				});
			}

			function processWindData(cityPinyin) {
				const cityData = historicalData[cityPinyin];
				if (!cityData || !cityData.data) {
					console.warn(`æ²¡æœ‰æ‰¾åˆ°${cityPinyin}çš„æ•°æ®`);
					return generateFallbackWindData();
				}

				const windData = {};
				let totalDays = 0;

				// åˆå§‹åŒ–8ä¸ªæ–¹å‘çš„æ•°æ®ç»“æ„
				const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
				directions.forEach(dir => {
					windData[dir] = {
						totalSpeed: 0,
						count: 0,
						frequency: 0,
						avgSpeed: 0
					};
				});

				// å¤„ç†æ¯æ¡æ•°æ®
				cityData.data.forEach(day => {
					if (day['é£å‘é£åŠ›']) {
						totalDays++;

						// è§£æé£å‘å’Œé£åŠ›
						const windInfo = parseWindInfo(day['é£å‘é£åŠ›']);

						if (windInfo.direction && windInfo.speed) {
							// å°†ä¸­æ–‡é£å‘è½¬æ¢ä¸ºæ ‡å‡†8æ–¹ä½
							const stdDirection = convertChineseWindDirectionTo8(windInfo.direction);

							if (windData[stdDirection]) {
								windData[stdDirection].totalSpeed += windInfo.speed;
								windData[stdDirection].count++;
							} else {
								console.warn(`æœªçŸ¥é£å‘: ${windInfo.direction}, è½¬æ¢ä¸º: ${stdDirection}`);
							}
						}
					}
				});

				// è®¡ç®—å¹³å‡å€¼å’Œé¢‘ç‡
				directions.forEach(dir => {
					if (windData[dir].count > 0) {
						windData[dir].avgSpeed = windData[dir].totalSpeed / windData[dir].count;
						windData[dir].frequency = (windData[dir].count / totalDays) * 100;
					}
				});

				// æ›´æ–°åŸå¸‚åç§°æ˜¾ç¤º
				const cityNameElement = document.getElementById('wind-rose-city');
				if (cityNameElement && cityData.name) {
					cityNameElement.textContent = `${cityData.name}é£å‘æ•°æ®`;
				}

				return windData;
			}

			// è§£æé£å‘é£åŠ›å­—ç¬¦ä¸²
			function parseWindInfo(windStr) {
				// ç¤ºä¾‹æ ¼å¼: "ä¸œåŒ—é£ 1çº§"
				const directionMatch = windStr.match(/([\u4e00-\u9fa5]+é£)/);
				const speedMatch = windStr.match(/(\d+)çº§/);

				let direction = null;
				let speed = 0;

				if (directionMatch) {
					direction = directionMatch[1];
				}

				if (speedMatch) {
					speed = parseFloat(speedMatch[1]);
					// å°†é£çº§è½¬æ¢ä¸ºé£é€Ÿ(km/h)ï¼Œä½¿ç”¨è¿‘ä¼¼å…¬å¼: é£é€Ÿ â‰ˆ é£çº§ * 5
					speed = speed * 5;
				}

				return {
					direction,
					speed
				};
			}

			// ç”Ÿæˆå¤‡ç”¨æ•°æ®ï¼ˆå½“çœŸå®æ•°æ®ä¸å¯ç”¨æ—¶ï¼‰
			function generateFallbackWindData() {
				const directions = ['N', 'NE', 'E', 'SE', 'S', 'SSE', 'SE', 'ESE',
					'E', 'ENE', 'NE', 'NNE', 'N', 'NNW', 'NW', 'WNW'
				];
				const windData = {};

				directions.forEach(dir => {
					windData[dir] = {
						avgSpeed: Math.random() * 15 + 5,
						frequency: Math.random() * 10
					};
				});

				return windData;
			}

			// æ–°å¢å‡½æ•°ï¼šå°†ä¸­æ–‡é£å‘è½¬æ¢ä¸º8ä¸ªæ ‡å‡†æ–¹å‘
			function convertChineseWindDirectionTo8(chineseDir) {
				// æ›´ç²¾ç¡®çš„æ˜ å°„
				const directionMap = {
					'åŒ—é£': 'N',
					'ä¸œåŒ—é£': 'NE',
					'ä¸œé£': 'E',
					'ä¸œå—é£': 'SE',
					'å—é£': 'S',
					'è¥¿å—é£': 'SW',
					'è¥¿é£': 'W',
					'è¥¿åŒ—é£': 'NW',
					'åŒ—': 'N',
					'ä¸œåŒ—': 'NE',
					'ä¸œ': 'E',
					'ä¸œå—': 'SE',
					'å—': 'S',
					'è¥¿å—': 'SW',
					'è¥¿': 'W',
					'è¥¿åŒ—': 'NW'
				};

				// å°è¯•ç²¾ç¡®åŒ¹é…
				if (directionMap[chineseDir]) {
					return directionMap[chineseDir];
				}

				// å°è¯•åŒ…å«åŒ¹é…
				for (const key in directionMap) {
					if (chineseDir.includes(key)) {
						return directionMap[key];
					}
				}

				console.warn(`æ— æ³•è¯†åˆ«é£å‘: ${chineseDir}ï¼Œä½¿ç”¨é»˜è®¤å€¼åŒ—é£`);
				return 'N'; // é»˜è®¤è¿”å›åŒ—é£
			}

			// åˆå§‹åŒ–é¡µé¢
			document.addEventListener('DOMContentLoaded', function() {
				// åŠ è½½èµ„æº
				loadResources();
				// åŠ è½½å†å²æ•°æ®
				loadHistoricalData();

				// åˆå§‹åŒ–å›¾è¡¨
				initWindyChart();
				initCityCharts();
				initDataCharts();

				// å¯åŠ¨æ•°æ®è½®è¯¢
				startDataPolling();

				// ä¸ºé£å‘ç«ç‘°å›¾é“¾æ¥æ·»åŠ ç‚¹å‡»äº‹ä»¶
				const windRoseLink = document.getElementById('wind-rose-link');
				if (windRoseLink) {
					windRoseLink.addEventListener('click', function(e) {
						e.preventDefault();
						// å­˜å‚¨æ•°æ®åˆ°localStorageï¼Œä»¥ä¾¿æ–°é¡µé¢ä½¿ç”¨
						localStorage.setItem('windRoseData', JSON.stringify(processWindData('beijing')));
						// æ‰“å¼€æ–°é¡µé¢
						window.open('wind-rose.html?city=beijing', '_blank');
					});
				}

				// æ—¶é—´æ§åˆ¶æŒ‰é’®äº‹ä»¶
				const rewindBtn = getElementSafe('rewind-btn');
				const forwardBtn = getElementSafe('forward-btn');

				if (rewindBtn) {
					rewindBtn.addEventListener('click', function() {
						updateStatus('å›é€€æ—¶é—´...');
						setTimeout(() => updateStatus('é£åœºæ•°æ®åŠ è½½å®Œæˆ'), 500);
					}, {
						passive: true
					});
				}

				if (forwardBtn) {
					forwardBtn.addEventListener('click', function() {
						updateStatus('å‰è¿›æ—¶é—´...');
						setTimeout(() => updateStatus('é£åœºæ•°æ®åŠ è½½å®Œæˆ'), 500);
					}, {
						passive: true
					});
				}

				// æ›´æ–°åœ°å›¾ä¿¡æ¯æ˜¾ç¤º
				if (windyChart) {
					windyChart.on('mousemove', function(params) {
						if (params.componentType === 'geo' && params.name) {
							const lonValue = getElementSafe('lon-value');
							const latValue = getElementSafe('lat-value');
							const windValue = getElementSafe('wind-value');
							const windDir = getElementSafe('wind-dir');
							const tempValue = getElementSafe('temp-value');
							const humidityValue = getElementSafe('humidity-value');

							if (lonValue) lonValue.textContent = `${params.value[0].toFixed(2)}Â°E`;
							if (latValue) latValue.textContent = `${params.value[1].toFixed(2)}Â°N`;

							// éšæœºç”Ÿæˆä¸€äº›æ°”è±¡æ•°æ®
							const windSpeed = (Math.random() * 15 + 5).toFixed(1);
							const windDirections = ['åŒ—é£', 'ä¸œåŒ—é£', 'ä¸œé£', 'ä¸œå—é£', 'å—é£', 'è¥¿å—é£', 'è¥¿é£', 'è¥¿åŒ—é£'];
							const randomWindDir = windDirections[Math.floor(Math.random() * windDirections
								.length)];
							const temp = (20 + Math.random() * 15).toFixed(1);
							const humidity = (40 + Math.random() * 40).toFixed(0);

							if (windValue) windValue.textContent = `${windSpeed} km/h`;
							if (windDir) windDir.textContent = randomWindDir;
							if (tempValue) tempValue.textContent = `${temp}Â°C`;
							if (humidityValue) humidityValue.textContent = `${humidity}%`;
						}
					});
				}
			});
		</script>
	</body>
</html>